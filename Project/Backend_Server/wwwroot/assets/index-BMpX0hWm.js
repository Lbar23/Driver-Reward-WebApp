import{j as e,r as a,aF as R,aG as Ce,aH as he,aI as Dr,aJ as Rr,h as Ar,aK as Pr,aL as H,aM as Tr,aN as Te,aO as Mr,aP as Er}from"./vendor-DTuGPK_9.js";import{B as Or,b as Lr,I as Y,L as Me,a as Ee,c as Be,d as Ue,e as Se,E as Wr,f as nr,C as zr,D as $r,A as ye,S as He,g as Ie,P as _e,h as ke,H as je,i as te,j as oe,k as Nr,T as h,l as T,m as ir,n as Vr,o as B,p as lr,N as Fr,q as J,r as cr,u as Br,s as Le,t as x,M as dr,v as S,w as Ur,x as Hr,y as ur,z as We,F as _r,G as Gr,J as pr,K as C,O as fe,Q as Ge,R as qr,U as Yr,V as Zr,W as Qr,X as Jr,Y as Kr,Z as hr,_ as $,$ as Xr,a0 as De,a1 as es,a2 as rs,a3 as qe,a4 as Ye,a5 as ss,a6 as ts,a7 as os,a8 as xr,a9 as we,aa as P,ab as ee,ac as W,ad as A,ae as Oe,af as ne,ag as ze,ah as $e,ai as G,aj as q,ak as O,al as X,am as ae,an as ie,ao as le,ap as ce,aq as L,ar as m,as as de,at as be,au as as,av as Ze,aw as Qe,ax as ns,ay as gr,az as is,aA as ls,aB as cs,aC as ds,aD as us,aE as ps,aF as Je,aG as Ke,aH as hs,aI as xs,aJ as Ne,aK as Ve,aL as gs,aM as ms,aN as js,aO as bs,aP as mr,aQ as jr,aR as br,aS as vr,aT as vs,aU as ys,aV as fs,aW as Xe,aX as er,aY as Ss}from"./mui-QUxxDNcQ.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))d(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&d(l)}).observe(document,{childList:!0,subtree:!0});function t(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function d(n){if(n.ep)return;n.ep=!0;const i=t(n);fetch(n.href,i)}})();function Fe({showBadge:r=!1,...s}){return e.jsx(Or,{color:"error",variant:"dot",invisible:!r,sx:{[`& .${Lr.badge}`]:{right:2,top:2}},children:e.jsx(Y,{size:"small",...s})})}const yr=a.createContext(void 0),Cs=({children:r})=>{const[s,t]=a.useState(()=>sessionStorage.getItem("isAuthenticated")==="true"),[d,n]=a.useState(()=>{const o=sessionStorage.getItem("user");return o?JSON.parse(o):null}),[i,l]=a.useState(()=>sessionStorage.getItem("viewRole")||null),[u,b]=a.useState(!s),v=a.useCallback(o=>{l(o),o?sessionStorage.setItem("viewRole",o):sessionStorage.removeItem("viewRole")},[]);a.useEffect(()=>{s?b(!1):g()},[]);const g=async()=>{b(!0);try{const o=await R.get("/api/user/currentuser",{withCredentials:!0});n(o.data),t(!0),sessionStorage.setItem("user",JSON.stringify(o.data)),sessionStorage.setItem("isAuthenticated","true")}catch{n(null),t(!1),sessionStorage.removeItem("user"),sessionStorage.removeItem("isAuthenticated")}finally{b(!1)}},c=async()=>{try{await R.post("/api/user/logout",{},{withCredentials:!0}),n(null),t(!1),v(null),sessionStorage.clear()}catch(o){console.error("Logout failed:",o)}};return e.jsx(yr.Provider,{value:{user:d,isAuthenticated:s,isLoading:u,viewRole:i,setViewRole:v,checkAuth:g,logout:c},children:r})},re=()=>{const r=a.useContext(yr);if(!r)throw new Error("useAuth must be used within an AuthProvider");return r},fr=a.createContext(void 0),Sr=()=>{const r=a.useContext(fr);if(!r)throw new Error("useView must be used within a ViewProvider");return r},ws=({children:r})=>{const[s,t]=a.useState("MAIN");return e.jsx(fr.Provider,{value:{currentView:s,setCurrentView:t},children:r})},rr={base:[{text:"Dashboard",icon:e.jsx($r,{}),view:"MAIN"}],Guest:[{text:"Applications",icon:e.jsx(ye,{}),view:"DRIVER_APPLICATION"}],Driver:[{text:"Applications",icon:e.jsx(ye,{}),view:"DRIVER_APPLICATION"},{text:"Product Catalog",icon:e.jsx(He,{}),path:"/catalog"},{text:"Register With Sponsors",icon:e.jsx(ye,{}),view:"DRIVER_REGISTRATION"},{text:"Points",icon:e.jsx(Ie,{}),view:"DRIVER_POINTS"},{text:"Activity",icon:e.jsx(Ie,{}),view:"DRIVER_ACTIVITY"}],Admin:[{text:"Manage Users",icon:e.jsx(_e,{}),nestedItems:[{text:"Drivers",icon:e.jsx(ke,{}),view:"MANAGE_DRIVERS"},{text:"Sponsors",icon:e.jsx(ke,{}),view:"MANAGE_SPONSORS"},{text:"Admins",icon:e.jsx(ke,{}),view:"MANAGE_ADMINS"}]},{text:"Reports Views",icon:e.jsx(je,{}),nestedItems:[{text:"General",icon:e.jsx(je,{}),view:"ADMIN_REPORTS"},{text:"Audits",icon:e.jsx(je,{}),view:"ADMIN_AUDIT_REPORTS"}]}],Sponsor:[{text:"Manage Drivers",icon:e.jsx(_e,{}),view:"SPONSOR_DRIVERS"},{text:"Approve/Reject Applications",icon:e.jsx(ye,{}),view:"APPLICATION_MANAGER"},{text:"Product Catalog",icon:e.jsx(He,{}),path:"/catalog"},{text:"Reports Views",icon:e.jsx(je,{}),nestedItems:[{text:"General",icon:e.jsx(Ie,{}),view:"SPONSOR_REPORTS"},{text:"Audits",icon:e.jsx(je,{}),view:"SPONSOR_AUDIT_REPORTS"}]}]};function Cr(){const{setCurrentView:r}=Sr(),{user:s,viewRole:t}=re(),d=Ce(),n=t||(s==null?void 0:s.userType)||"Guest",[i,l]=a.useState({}),u=[...rr.base,...rr[n]||[]],b=g=>{l(c=>({...c,[g]:!c[g]}))},v=(g,c)=>{c?d(c):g&&r(g)};return e.jsx(Me,{dense:!0,children:u.map((g,c)=>e.jsxs(a.Fragment,{children:[e.jsx(Ee,{disablePadding:!0,children:e.jsxs(Be,{onClick:()=>g.nestedItems?b(g.text):v(g.view,g.path),children:[e.jsx(Ue,{children:g.icon}),e.jsx(Se,{primary:g.text}),g.nestedItems?i[g.text]?e.jsx(Wr,{}):e.jsx(nr,{}):null]})}),g.nestedItems&&e.jsx(zr,{in:i[g.text],timeout:"auto",unmountOnExit:!0,children:e.jsx(Me,{component:"div",disablePadding:!0,children:g.nestedItems.map((o,j)=>e.jsx(Ee,{disablePadding:!0,children:e.jsxs(Be,{onClick:()=>v(o.view,o.path),children:[e.jsx(Ue,{children:o.icon}),e.jsx(Se,{primary:o.text})]})},j))})})]},c))})}function Is(){return e.jsx(te,{variant:"outlined",sx:{m:1.5,p:1.5},children:e.jsxs(oe,{children:[e.jsx(Nr,{fontSize:"small"}),e.jsx(h,{gutterBottom:!0,sx:{fontWeight:600},children:"Something"}),e.jsx(h,{variant:"body2",sx:{mb:2,color:"text.secondary"},children:"Earn points by driving safe!"}),e.jsx(T,{variant:"contained",size:"small",fullWidth:!0,children:"Make the pledge"})]})})}function ks({open:r,toggleDrawer:s}){const{user:t,viewRole:d,logout:n}=re(),i=d?{userName:`Viewing as ${d}`,email:`${d.toLowerCase()}@example.com`,userType:d}:t;return e.jsx(ir,{anchor:"right",open:r,onClose:s(!1),sx:{zIndex:l=>l.zIndex.drawer+1,[`& .${Vr.paper}`]:{backgroundImage:"none",backgroundColor:"background.paper"}},children:e.jsxs(B,{sx:{maxWidth:"70dvw",height:"100%"},children:[e.jsxs(B,{direction:"row",sx:{p:2,pb:0,gap:1},children:[i?e.jsxs(B,{direction:"row",sx:{gap:1,alignItems:"center",flexGrow:1,p:1},children:[e.jsx(lr,{alt:i.userName,src:"/static/images/avatar/7.jpg",sx:{width:24,height:24}}),e.jsx(h,{component:"p",variant:"h6",children:i.userName})]}):e.jsx(h,{variant:"body2",sx:{flexGrow:1,p:1},children:"Please log in to access more features."}),e.jsx(Fe,{showBadge:!0,children:e.jsx(Fr,{})})]}),e.jsx(J,{}),e.jsxs(B,{sx:{flexGrow:1},children:[e.jsx(Cr,{}),e.jsx(J,{})]}),e.jsx(Is,{}),i&&e.jsx(B,{sx:{p:2},children:e.jsx(T,{variant:"outlined",fullWidth:!0,startIcon:e.jsx(cr,{}),onClick:n,children:"Logout"})})]})})}function Ds(r){const{mode:s,systemMode:t,setMode:d}=Br(),n=Le(),[i,l]=a.useState(null),u=!!i,b=j=>{l(j.currentTarget)},v=()=>{l(null)},g=j=>()=>{d(j),v()};if(!s)return e.jsx(x,{"data-screenshot":"toggle-mode",sx:{verticalAlign:"bottom",display:"inline-flex",width:"2.25rem",height:"2.25rem",borderRadius:n.shape.borderRadius,border:"1px solid",borderColor:n.palette.divider}});const o=(t||s)==="light"?e.jsx(Ur,{}):e.jsx(Hr,{});return e.jsxs(a.Fragment,{children:[e.jsx(Y,{"data-screenshot":"toggle-mode",onClick:b,disableRipple:!0,size:"small","aria-controls":u?"color-scheme-menu":void 0,"aria-haspopup":"true","aria-expanded":u?"true":void 0,...r,children:o}),e.jsxs(dr,{anchorEl:i,id:"color-scheme-menu",open:u,onClose:v,onClick:v,PaperProps:{variant:"outlined",sx:{my:"4px"}},transformOrigin:{horizontal:"right",vertical:"top"},anchorOrigin:{horizontal:"right",vertical:"bottom"},children:[e.jsx(S,{selected:s==="system",onClick:g("system"),children:"System"}),e.jsx(S,{selected:s==="light",onClick:g("light"),children:"Light"}),e.jsx(S,{selected:s==="dark",onClick:g("dark"),children:"Dark"})]})]})}function Rs(){const[r,s]=a.useState(!1);re();const t=d=>()=>{s(d)};return e.jsx(ur,{position:"fixed",sx:{zIndex:d=>d.zIndex.drawer+1,boxShadow:0,bgcolor:"background.paper",borderBottom:"1px solid",borderColor:"divider",maxWidth:"100vw",overflow:"hidden"},children:e.jsxs(We,{sx:{display:"flex",justifyContent:"space-between",flexWrap:"wrap",gap:1,maxWidth:"100%",overflow:"hidden"},children:[e.jsxs(x,{sx:{display:"flex",alignItems:"center",gap:1,flexShrink:0},children:[e.jsx(As,{}),e.jsx(h,{variant:"h5",component:"a",href:"/",sx:{color:"text.primary",textDecoration:"none",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:"GitGud Drivers"})]}),e.jsxs(x,{sx:{display:"flex",alignItems:"center",gap:{xs:1,md:2},flexWrap:"wrap",justifyContent:"flex-end",width:{xs:"100%",md:"auto"}},children:[e.jsx(h,{component:he,to:"/about",sx:{color:"text.primary",textDecoration:"none",fontSize:{xs:"0.9rem",md:"1rem"},whiteSpace:"nowrap"},children:"About"}),e.jsx(h,{component:he,to:"/faq",sx:{color:"text.primary",textDecoration:"none",fontSize:{xs:"0.9rem",md:"1rem"},whiteSpace:"nowrap"},children:"FAQ"}),e.jsx(Ds,{}),e.jsxs(x,{sx:{display:{xs:"block",md:"none"}},children:[e.jsx(Fe,{"aria-label":"menu",onClick:t(!0),children:e.jsx(_r,{})}),e.jsx(ks,{open:r,toggleDrawer:t})]})]})]})})}function As(){return e.jsx(x,{sx:{width:"1.5rem",height:"1.5rem",bgcolor:"black",borderRadius:"999px",display:"flex",justifyContent:"center",alignItems:"center",backgroundImage:"linear-gradient(135deg, hsl(210, 98%, 60%) 0%, hsl(210, 100%, 35%) 100%)",color:"hsla(210, 100%, 95%, 0.9)",border:"1px solid",borderColor:"hsl(210, 100%, 55%)",boxShadow:"inset 0 2px 5px rgba(255, 255, 255, 0.3)"},children:e.jsx(Gr,{color:"inherit",sx:{fontSize:"1rem"}})})}const _=pr();[..._.shadows];const f={50:"hsl(210, 100%, 95%)",100:"hsl(210, 100%, 92%)",200:"hsl(210, 100%, 80%)",300:"hsl(210, 100%, 65%)",400:"hsl(210, 98%, 48%)",500:"hsl(210, 98%, 42%)",600:"hsl(210, 98%, 55%)",700:"hsl(210, 100%, 35%)",800:"hsl(210, 100%, 16%)",900:"hsl(210, 100%, 21%)"},p={50:"hsl(220, 35%, 97%)",100:"hsl(220, 30%, 94%)",200:"hsl(220, 20%, 88%)",300:"hsl(220, 20%, 80%)",400:"hsl(220, 20%, 65%)",500:"hsl(220, 20%, 42%)",600:"hsl(220, 20%, 35%)",700:"hsl(220, 20%, 25%)",800:"hsl(220, 30%, 6%)",900:"hsl(220, 35%, 3%)"},V={50:"hsl(120, 80%, 98%)",100:"hsl(120, 75%, 94%)",200:"hsl(120, 75%, 87%)",300:"hsl(120, 61%, 77%)",400:"hsl(120, 44%, 53%)",500:"hsl(120, 59%, 30%)",600:"hsl(120, 70%, 25%)",700:"hsl(120, 75%, 16%)",800:"hsl(120, 84%, 10%)",900:"hsl(120, 87%, 6%)"},Z={50:"hsl(45, 100%, 97%)",100:"hsl(45, 92%, 90%)",200:"hsl(45, 94%, 80%)",300:"hsl(45, 90%, 65%)",400:"hsl(45, 90%, 40%)",500:"hsl(45, 90%, 35%)",600:"hsl(45, 91%, 25%)",700:"hsl(45, 94%, 20%)",800:"hsl(45, 95%, 16%)",900:"hsl(45, 93%, 12%)"},F={50:"hsl(0, 100%, 97%)",100:"hsl(0, 92%, 90%)",200:"hsl(0, 94%, 80%)",300:"hsl(0, 90%, 65%)",400:"hsl(0, 90%, 40%)",500:"hsl(0, 90%, 30%)",600:"hsl(0, 91%, 25%)",700:"hsl(0, 94%, 18%)",800:"hsl(0, 95%, 12%)",900:"hsl(0, 93%, 6%)"},Ps={light:{palette:{primary:{light:f[200],main:f[400],dark:f[700],contrastText:f[50]},info:{light:f[100],main:f[300],dark:f[600],contrastText:p[50]},warning:{light:Z[300],main:Z[400],dark:Z[800]},error:{light:F[300],main:F[400],dark:F[800]},success:{light:V[300],main:V[400],dark:V[800]},grey:{...p},divider:C(p[300],.4),background:{default:"hsl(0, 0%, 99%)",paper:"hsl(220, 35%, 97%)"},text:{primary:p[800],secondary:p[600],warning:Z[400]},action:{hover:C(p[200],.2),selected:`${C(p[200],.3)}`},baseShadow:"hsla(220, 30%, 5%, 0.07) 0px 4px 16px 0px, hsla(220, 25%, 10%, 0.07) 0px 8px 16px -5px"}},dark:{palette:{primary:{contrastText:f[50],light:f[300],main:f[400],dark:f[700]},info:{contrastText:f[300],light:f[500],main:f[700],dark:f[900]},warning:{light:Z[400],main:Z[500],dark:Z[700]},error:{light:F[400],main:F[500],dark:F[700]},success:{light:V[400],main:V[500],dark:V[700]},grey:{...p},divider:C(p[700],.6),background:{default:p[900],paper:"hsl(220, 30%, 7%)"},text:{primary:"hsl(0, 0%, 100%)",secondary:p[400]},action:{hover:C(p[600],.2),selected:C(p[600],.3)},baseShadow:"hsla(220, 30%, 5%, 0.7) 0px 4px 16px 0px, hsla(220, 25%, 10%, 0.8) 0px 8px 16px -5px"}}};['"Inter", "sans-serif"'].join(","),_.typography.pxToRem(48),_.typography.pxToRem(36),_.typography.pxToRem(30),_.typography.pxToRem(24),_.typography.pxToRem(20),_.typography.pxToRem(18),_.typography.pxToRem(18),_.typography.pxToRem(14),_.typography.pxToRem(14),_.typography.pxToRem(14),_.typography.pxToRem(12);const Ts={borderRadius:8},Ms=["none","var(--template-palette-baseShadow)",..._.shadows.slice(2)],Es=Ms,Os={MuiButtonBase:{defaultProps:{disableTouchRipple:!0,disableRipple:!0},styleOverrides:{root:({theme:r})=>({boxSizing:"border-box",transition:"all 100ms ease-in","&:focus-visible":{outline:`3px solid ${C(r.palette.primary.main,.5)}`,outlineOffset:"2px"}})}},MuiButton:{styleOverrides:{root:({theme:r})=>({boxShadow:"none",borderRadius:r.shape.borderRadius,textTransform:"none",variants:[{props:{size:"small"},style:{height:"2.25rem",padding:"8px 12px"}},{props:{size:"medium"},style:{height:"2.5rem"}},{props:{color:"primary",variant:"contained"},style:{color:"white",backgroundColor:p[900],backgroundImage:`linear-gradient(to bottom, ${p[700]}, ${p[800]})`,boxShadow:`inset 0 1px 0 ${p[600]}, inset 0 -1px 0 1px hsl(220, 0%, 0%)`,border:`1px solid ${p[700]}`,"&:hover":{backgroundImage:"none",backgroundColor:p[700],boxShadow:"none"},"&:active":{backgroundColor:p[800]},...r.applyStyles("dark",{color:"black",backgroundColor:p[50],backgroundImage:`linear-gradient(to bottom, ${p[100]}, ${p[50]})`,boxShadow:"inset 0 -1px 0  hsl(220, 30%, 80%)",border:`1px solid ${p[50]}`,"&:hover":{backgroundImage:"none",backgroundColor:p[300],boxShadow:"none"},"&:active":{backgroundColor:p[400]}})}},{props:{color:"secondary",variant:"contained"},style:{color:"white",backgroundColor:f[300],backgroundImage:`linear-gradient(to bottom, ${C(f[400],.8)}, ${f[500]})`,boxShadow:`inset 0 2px 0 ${C(f[200],.2)}, inset 0 -2px 0 ${C(f[700],.4)}`,border:`1px solid ${f[500]}`,"&:hover":{backgroundColor:f[700],boxShadow:"none"},"&:active":{backgroundColor:f[700],backgroundImage:"none"}}},{props:{variant:"outlined"},style:{color:r.palette.text.primary,border:"1px solid",borderColor:p[200],backgroundColor:C(p[50],.3),"&:hover":{backgroundColor:p[100],borderColor:p[300]},"&:active":{backgroundColor:p[200]},...r.applyStyles("dark",{backgroundColor:p[800],borderColor:p[700],"&:hover":{backgroundColor:p[900],borderColor:p[600]},"&:active":{backgroundColor:p[900]}})}},{props:{color:"secondary",variant:"outlined"},style:{color:f[700],border:"1px solid",borderColor:f[200],backgroundColor:f[50],"&:hover":{backgroundColor:f[100],borderColor:f[400]},"&:active":{backgroundColor:C(f[200],.7)},...r.applyStyles("dark",{color:f[50],border:"1px solid",borderColor:f[900],backgroundColor:C(f[900],.3),"&:hover":{borderColor:f[700],backgroundColor:C(f[900],.6)},"&:active":{backgroundColor:C(f[900],.5)}})}},{props:{variant:"text"},style:{color:p[600],"&:hover":{backgroundColor:p[100]},"&:active":{backgroundColor:p[200]},...r.applyStyles("dark",{color:p[50],"&:hover":{backgroundColor:p[700]},"&:active":{backgroundColor:C(p[700],.7)}})}},{props:{color:"secondary",variant:"text"},style:{color:f[700],"&:hover":{backgroundColor:C(f[100],.5)},"&:active":{backgroundColor:C(f[200],.7)},...r.applyStyles("dark",{color:f[100],"&:hover":{backgroundColor:C(f[900],.5)},"&:active":{backgroundColor:C(f[900],.3)}})}}]})}},MuiIconButton:{styleOverrides:{root:({theme:r})=>({boxShadow:"none",borderRadius:r.shape.borderRadius,textTransform:"none",fontWeight:r.typography.fontWeightMedium,letterSpacing:0,color:r.palette.text.primary,border:"1px solid ",borderColor:p[200],backgroundColor:C(p[50],.3),"&:hover":{backgroundColor:p[100],borderColor:p[300]},"&:active":{backgroundColor:p[200]},...r.applyStyles("dark",{backgroundColor:p[800],borderColor:p[700],"&:hover":{backgroundColor:p[900],borderColor:p[600]},"&:active":{backgroundColor:p[900]}}),variants:[{props:{size:"small"},style:{width:"2.25rem",height:"2.25rem",padding:"0.25rem",[`& .${fe.root}`]:{fontSize:"1rem"}}},{props:{size:"medium"},style:{width:"2.5rem",height:"2.5rem"}}]})}},MuiToggleButtonGroup:{styleOverrides:{root:({theme:r})=>({borderRadius:"10px",boxShadow:`0 4px 16px ${C(p[400],.2)}`,[`& .${Ge.selected}`]:{color:f[500]},...r.applyStyles("dark",{[`& .${Ge.selected}`]:{color:"#fff"},boxShadow:`0 4px 16px ${C(f[700],.5)}`})})}},MuiToggleButton:{styleOverrides:{root:({theme:r})=>({padding:"12px 16px",textTransform:"none",borderRadius:"10px",fontWeight:500,...r.applyStyles("dark",{color:p[400],boxShadow:"0 4px 16px rgba(0, 0, 0, 0.5)",[`&.${qr.selected}`]:{color:f[300]}})})}},MuiCheckbox:{defaultProps:{disableRipple:!0,icon:e.jsx(Yr,{sx:{color:"hsla(210, 0%, 0%, 0.0)"}}),checkedIcon:e.jsx(Zr,{sx:{height:14,width:14}}),indeterminateIcon:e.jsx(Qr,{sx:{height:14,width:14}})},styleOverrides:{root:({theme:r})=>({margin:10,height:16,width:16,borderRadius:5,border:"1px solid ",borderColor:C(p[300],.8),boxShadow:"0 0 0 1.5px hsla(210, 0%, 0%, 0.04) inset",backgroundColor:C(p[100],.4),transition:"border-color, background-color, 120ms ease-in","&:hover":{borderColor:f[300]},"&.Mui-focusVisible":{outline:`3px solid ${C(f[500],.5)}`,outlineOffset:"2px",borderColor:f[400]},"&.Mui-checked":{color:"white",backgroundColor:f[500],borderColor:f[500],boxShadow:"none","&:hover":{backgroundColor:f[600]}},...r.applyStyles("dark",{borderColor:C(p[700],.8),boxShadow:"0 0 0 1.5px hsl(210, 0%, 0%) inset",backgroundColor:C(p[900],.8),"&:hover":{borderColor:f[300]},"&.Mui-focusVisible":{borderColor:f[400],outline:`3px solid ${C(f[500],.5)}`,outlineOffset:"2px"}})})}},MuiInputBase:{styleOverrides:{root:{border:"none"},input:{"&::placeholder":{opacity:.7,color:p[500]}}}},MuiOutlinedInput:{styleOverrides:{input:{padding:0},root:({theme:r})=>({padding:"8px 12px",color:r.palette.text.primary,borderRadius:r.shape.borderRadius,border:`1px solid ${r.palette.divider}`,backgroundColor:r.palette.background.default,transition:"border 120ms ease-in","&:hover":{borderColor:p[400]},[`&.${Jr.focused}`]:{outline:`3px solid ${C(f[500],.5)}`,borderColor:f[400]},...r.applyStyles("dark",{"&:hover":{borderColor:p[500]}}),variants:[{props:{size:"small"},style:{height:"2.25rem"}},{props:{size:"medium"},style:{height:"2.5rem"}}]}),notchedOutline:{border:"none"}}},MuiInputAdornment:{styleOverrides:{root:({theme:r})=>({color:r.palette.grey[500],...r.applyStyles("dark",{color:r.palette.grey[400]})})}},MuiFormLabel:{styleOverrides:{root:({theme:r})=>({typography:r.typography.caption,marginBottom:8})}}},Ls={MuiList:{styleOverrides:{root:{padding:"8px",display:"flex",flexDirection:"column",gap:0}}},MuiListItem:{styleOverrides:{root:({theme:r})=>({[`& .${fe.root}`]:{width:"1rem",height:"1rem",color:r.palette.text.secondary},[`& .${Kr.root}`]:{fontWeight:500},[`& .${hr.root}`]:{display:"flex",gap:8,padding:"2px 8px",borderRadius:r.shape.borderRadius,opacity:.7,"&.Mui-selected":{opacity:1,backgroundColor:C(r.palette.action.selected,.3),[`& .${fe.root}`]:{color:r.palette.text.primary},"&:focus-visible":{backgroundColor:C(r.palette.action.selected,.3)},"&:hover":{backgroundColor:C(r.palette.action.selected,.5)}},"&:focus-visible":{backgroundColor:"transparent"}}})}},MuiListItemText:{styleOverrides:{primary:({theme:r})=>({fontSize:r.typography.body2.fontSize,fontWeight:500,lineHeight:r.typography.body2.lineHeight}),secondary:({theme:r})=>({fontSize:r.typography.caption.fontSize,lineHeight:r.typography.caption.lineHeight})}},MuiListSubheader:{styleOverrides:{root:({theme:r})=>({backgroundColor:"transparent",padding:"4px 8px",fontSize:r.typography.caption.fontSize,fontWeight:500,lineHeight:r.typography.caption.lineHeight})}},MuiListItemIcon:{styleOverrides:{root:{minWidth:0}}},MuiChip:{defaultProps:{size:"small"},styleOverrides:{root:({theme:r})=>({border:"1px solid",borderRadius:"999px",[`& .${$.label}`]:{fontWeight:600},variants:[{props:{color:"default"},style:{borderColor:p[200],backgroundColor:p[100],[`& .${$.label}`]:{color:p[500]},[`& .${$.icon}`]:{color:p[500]},...r.applyStyles("dark",{borderColor:p[700],backgroundColor:p[800],[`& .${$.label}`]:{color:p[300]},[`& .${$.icon}`]:{color:p[300]}})}},{props:{color:"success"},style:{borderColor:V[200],backgroundColor:V[50],[`& .${$.label}`]:{color:V[500]},[`& .${$.icon}`]:{color:V[500]},...r.applyStyles("dark",{borderColor:V[800],backgroundColor:V[900],[`& .${$.label}`]:{color:V[300]},[`& .${$.icon}`]:{color:V[300]}})}},{props:{color:"error"},style:{borderColor:F[100],backgroundColor:F[50],[`& .${$.label}`]:{color:F[500]},[`& .${$.icon}`]:{color:F[500]},...r.applyStyles("dark",{borderColor:F[800],backgroundColor:F[900],[`& .${$.label}`]:{color:F[200]},[`& .${$.icon}`]:{color:F[300]}})}},{props:{size:"small"},style:{maxHeight:20,[`& .${$.label}`]:{fontSize:r.typography.caption.fontSize},[`& .${fe.root}`]:{fontSize:r.typography.caption.fontSize}}},{props:{size:"medium"},style:{[`& .${$.label}`]:{fontSize:r.typography.caption.fontSize}}}]})}},MuiTablePagination:{styleOverrides:{actions:{display:"flex",gap:8,marginRight:6,[`& .${Xr.root}`]:{minWidth:0,width:36,height:36}}}},MuiIcon:{defaultProps:{fontSize:"small"},styleOverrides:{root:{variants:[{props:{fontSize:"small"},style:{fontSize:"1rem"}}]}}}},Ws={MuiAlert:{styleOverrides:{root:({theme:r})=>({borderRadius:10,backgroundColor:Z[100],color:r.palette.text.primary,border:`1px solid ${C(Z[300],.5)}`,"& .MuiAlert-icon":{color:Z[500]},...r.applyStyles("dark",{backgroundColor:`${C(Z[900],.5)}`,border:`1px solid ${C(Z[800],.5)}`})})}},MuiDialog:{styleOverrides:{root:({theme:r})=>({"& .MuiDialog-paper":{borderRadius:"10px",border:"1px solid",borderColor:r.palette.divider}})}},MuiLinearProgress:{styleOverrides:{root:({theme:r})=>({height:8,borderRadius:8,backgroundColor:p[200],...r.applyStyles("dark",{backgroundColor:p[800]})})}}},zs={MuiMenuItem:{styleOverrides:{root:({theme:r})=>({borderRadius:r.shape.borderRadius,padding:"6px 8px",[`&.${De.focusVisible}`]:{backgroundColor:"transparent"},[`&.${De.selected}`]:{[`&.${De.focusVisible}`]:{backgroundColor:C(r.palette.action.selected,.3)}}})}},MuiMenu:{styleOverrides:{list:{gap:"0px",[`&.${es.root}`]:{margin:"0 -8px"}},paper:({theme:r})=>({marginTop:"4px",borderRadius:r.shape.borderRadius,border:`1px solid ${r.palette.divider}`,backgroundImage:"none",background:"hsl(0, 0%, 100%)",boxShadow:"hsla(220, 30%, 5%, 0.07) 0px 4px 16px 0px, hsla(220, 25%, 10%, 0.07) 0px 8px 16px -5px",[`& .${hr.root}`]:{"&.Mui-selected":{backgroundColor:C(r.palette.action.selected,.3)}},...r.applyStyles("dark",{background:p[900],boxShadow:"hsla(220, 30%, 5%, 0.7) 0px 4px 16px 0px, hsla(220, 25%, 10%, 0.8) 0px 8px 16px -5px"})})}},MuiSelect:{defaultProps:{IconComponent:a.forwardRef((r,s)=>e.jsx(rs,{fontSize:"small",...r,ref:s}))},styleOverrides:{root:({theme:r})=>({borderRadius:r.shape.borderRadius,border:"1px solid",borderColor:p[200],backgroundColor:r.palette.background.paper,boxShadow:"inset 0 1px 0 1px hsla(220, 0%, 100%, 0.6), inset 0 -1px 0 1px hsla(220, 35%, 90%, 0.5)","&:hover":{borderColor:p[300],backgroundColor:r.palette.background.paper,boxShadow:"none"},[`&.${qe.focused}`]:{outlineOffset:0,borderColor:p[400]},"&:before, &:after":{display:"none"},...r.applyStyles("dark",{borderRadius:r.shape.borderRadius,borderColor:p[700],backgroundColor:r.palette.background.paper,boxShadow:`inset 0 1px 0 1px ${C(p[700],.15)}, inset 0 -1px 0 1px hsla(220, 0%, 0%, 0.7)`,"&:hover":{borderColor:C(p[700],.7),backgroundColor:r.palette.background.paper,boxShadow:"none"},[`&.${qe.focused}`]:{outlineOffset:0,borderColor:p[900]},"&:before, &:after":{display:"none"}})}),select:({theme:r})=>({display:"flex",alignItems:"center",...r.applyStyles("dark",{display:"flex",alignItems:"center","&:focus-visible":{backgroundColor:p[900]}})})}},MuiLink:{defaultProps:{underline:"none"},styleOverrides:{root:({theme:r})=>({color:r.palette.text.primary,fontWeight:500,position:"relative",textDecoration:"none",width:"fit-content","&::before":{content:'""',position:"absolute",width:"100%",height:"1px",bottom:0,left:0,backgroundColor:r.palette.text.secondary,opacity:.3,transition:"width 0.3s ease, opacity 0.3s ease"},"&:hover::before":{width:0},"&:focus-visible":{outline:`3px solid ${C(f[500],.5)}`,outlineOffset:"4px",borderRadius:"2px"}})}},MuiDrawer:{styleOverrides:{paper:({theme:r})=>({backgroundColor:r.palette.background.default})}},MuiPaginationItem:{styleOverrides:{root:({theme:r})=>({"&.Mui-selected":{color:"white",backgroundColor:r.palette.grey[900]},...r.applyStyles("dark",{"&.Mui-selected":{color:"black",backgroundColor:r.palette.grey[50]}})})}},MuiTabs:{styleOverrides:{root:{minHeight:"fit-content"},indicator:({theme:r})=>({backgroundColor:r.palette.grey[800],...r.applyStyles("dark",{backgroundColor:r.palette.grey[200]})})}},MuiTab:{styleOverrides:{root:({theme:r})=>({padding:"6px 8px",marginBottom:"8px",textTransform:"none",minWidth:"fit-content",minHeight:"fit-content",color:r.palette.text.secondary,borderRadius:r.shape.borderRadius,border:"1px solid",borderColor:"transparent",":hover":{color:r.palette.text.primary,backgroundColor:p[100],borderColor:p[200]},[`&.${Ye.selected}`]:{color:p[900]},...r.applyStyles("dark",{":hover":{color:r.palette.text.primary,backgroundColor:p[800],borderColor:p[700]},[`&.${Ye.selected}`]:{color:"#fff"}})})}},MuiStepConnector:{styleOverrides:{line:({theme:r})=>({borderTop:"1px solid",borderColor:r.palette.divider,flex:1,borderRadius:"99px"})}},MuiStepIcon:{styleOverrides:{root:({theme:r})=>({color:"transparent",border:`1px solid ${p[400]}`,width:12,height:12,borderRadius:"50%","& text":{display:"none"},"&.Mui-active":{border:"none",color:r.palette.primary.main},"&.Mui-completed":{border:"none",color:r.palette.success.main},...r.applyStyles("dark",{border:`1px solid ${p[700]}`,"&.Mui-active":{border:"none",color:r.palette.primary.light},"&.Mui-completed":{border:"none",color:r.palette.success.light}}),variants:[{props:{completed:!0},style:{width:12,height:12}}]})}},MuiStepLabel:{styleOverrides:{label:({theme:r})=>({"&.Mui-completed":{opacity:.6,...r.applyStyles("dark",{opacity:.5})}})}}},$s={MuiAccordion:{defaultProps:{elevation:0,disableGutters:!0},styleOverrides:{root:({theme:r})=>({padding:4,overflow:"clip",backgroundColor:r.palette.background.default,border:"1px solid",borderColor:r.palette.divider,":before":{backgroundColor:"transparent"},"&:not(:last-of-type)":{borderBottom:"none"},"&:first-of-type":{borderTopLeftRadius:r.shape.borderRadius,borderTopRightRadius:r.shape.borderRadius},"&:last-of-type":{borderBottomLeftRadius:r.shape.borderRadius,borderBottomRightRadius:r.shape.borderRadius}})}},MuiAccordionSummary:{styleOverrides:{root:({theme:r})=>({border:"none",borderRadius:8,"&:hover":{backgroundColor:p[50]},"&:focus-visible":{backgroundColor:"transparent"},...r.applyStyles("dark",{"&:hover":{backgroundColor:p[800]}})})}},MuiAccordionDetails:{styleOverrides:{root:{mb:20,border:"none"}}},MuiPaper:{defaultProps:{elevation:0}},MuiCard:{styleOverrides:{root:({theme:r})=>({padding:16,gap:16,transition:"all 100ms ease",backgroundColor:p[50],borderRadius:r.shape.borderRadius,border:`1px solid ${r.palette.divider}`,boxShadow:"none",...r.applyStyles("dark",{backgroundColor:p[800]}),variants:[{props:{variant:"outlined"},style:{border:`1px solid ${r.palette.divider}`,boxShadow:"none",background:"hsl(0, 0%, 100%)",...r.applyStyles("dark",{background:C(p[900],.4)})}}]})}},MuiCardContent:{styleOverrides:{root:{padding:0,"&:last-child":{paddingBottom:0}}}},MuiCardHeader:{styleOverrides:{root:{padding:0}}},MuiCardActions:{styleOverrides:{root:{padding:0}}}};function Ns({children:r,disableCustomTheme:s,themeComponents:t}){const d=a.useMemo(()=>s?{}:pr({cssVariables:{colorSchemeSelector:"data-mui-color-scheme",cssVarPrefix:"template"},colorSchemes:Ps,shadows:Es,shape:Ts,components:{...Os,...Ls,...Ws,...zs,...$s,...t}}),[s,t]);return s?e.jsx(a.Fragment,{children:r}):e.jsx(ss,{theme:d,disableTransitionOnChange:!0,children:r})}const Vs=ts(S)({margin:"2px"}),Re=a.forwardRef(({to:r,children:s,onClick:t},d)=>e.jsx(S,{component:he,to:r,ref:d,onClick:t,children:s}));function Fs(){const[r,s]=a.useState(null),{logout:t}=re(),d=!!r,n=u=>{s(u.currentTarget)},i=()=>{s(null)},l=()=>{t(),i()};return e.jsxs(e.Fragment,{children:[e.jsx(Fe,{"aria-label":"Open menu",onClick:n,sx:{borderColor:"transparent"},children:e.jsx(os,{})}),e.jsxs(dr,{anchorEl:r,id:"menu",open:d,onClose:i,transformOrigin:{horizontal:"right",vertical:"top"},anchorOrigin:{horizontal:"right",vertical:"bottom"},sx:{"& .MuiList-root":{padding:"4px"},"& .MuiPaper-root":{padding:0}},children:[e.jsx(Re,{to:"/profile",onClick:i,children:"Profile"}),e.jsx(J,{}),e.jsx(Re,{to:"/settings",onClick:i,children:"Settings"}),e.jsx(Re,{to:"/feedback",onClick:i,children:"Feedback"}),e.jsx(J,{}),e.jsxs(Vs,{onClick:l,children:[e.jsx(cr,{fontSize:"small"}),e.jsx(Se,{children:"Logout"})]})]})]})}const sr=240;function Bs(){const{user:r,viewRole:s}=re(),t=s?{userName:`Viewing as ${s}`,email:`${s.toLowerCase()}@example.com`,userType:s}:r;return e.jsxs(x,{sx:{display:"flex"},children:[e.jsx(xr,{}),e.jsx(ur,{position:"fixed",sx:{zIndex:d=>d.zIndex.drawer+1}}),e.jsxs(ir,{variant:"permanent",sx:{display:{xs:"none",md:"block"},width:sr,flexShrink:0,"& .MuiDrawer-paper":{width:sr,boxSizing:"border-box"}},children:[e.jsx(We,{}),e.jsx(x,{sx:{overflow:"auto"},children:t&&e.jsxs(e.Fragment,{children:[e.jsxs(x,{sx:{display:"flex",alignItems:"center",p:2},children:[e.jsx(lr,{alt:t.userName,src:"/static/images/avatar/7.jpg",sx:{width:36,height:36}}),e.jsxs(x,{sx:{ml:2},children:[e.jsx(h,{variant:"body2",sx:{fontWeight:500,lineHeight:"16px"},children:t.userName}),e.jsx(h,{variant:"caption",sx:{color:"text.secondary"},children:t.email})]}),e.jsx(Fs,{})]}),e.jsx(J,{}),e.jsx(Cr,{})]})})]})]})}const Us=()=>{const r=Ce();return e.jsxs(we,{maxWidth:"lg",component:"main",role:"main","aria-label":"Git Gud Drivers Homepage",children:[e.jsxs(x,{component:"section","aria-labelledby":"hero-title",sx:{textAlign:"center",py:8,backgroundColor:"background.paper",borderRadius:2,mb:4},children:[e.jsx(h,{variant:"h2",component:"h1",gutterBottom:!0,id:"hero-title",children:"Git Gud Drivers"}),e.jsx(h,{variant:"h5",color:"text.secondary",paragraph:!0,component:"p",children:"A rewards program for professional drivers committed to excellence"}),e.jsxs(x,{role:"navigation","aria-label":"Account access",children:[e.jsx(T,{variant:"contained",size:"large",onClick:()=>r("/register"),sx:{mr:2,minHeight:"44px",minWidth:"88px"},"aria-label":"Sign up for Git Gud Drivers",children:"Sign Up"}),e.jsx(T,{variant:"outlined",size:"large",onClick:()=>r("/login"),sx:{minHeight:"44px",minWidth:"88px"},"aria-label":"Sign in to your account",children:"Sign In"})]})]}),e.jsx(P,{container:!0,spacing:4,sx:{mb:6},justifyContent:"center",alignItems:"center",component:"section","aria-labelledby":"how-it-works-title",children:e.jsxs(P,{item:!0,xs:12,md:4,component:"article",role:"article",children:[e.jsx(h,{variant:"h5",gutterBottom:!0,component:"h2",id:"how-it-works-title",children:"How It Works"}),e.jsxs(x,{component:"ol",sx:{listStyleType:"decimal",pl:3,mb:2},"aria-label":"Steps to join Git Gud Drivers",children:[e.jsx("li",{children:"Apply as a driver"}),e.jsx("li",{children:"Get approved by a sponsor"}),e.jsx("li",{children:"Start earning points"}),e.jsx("li",{children:"Redeem rewards"})]}),e.jsx(h,{variant:"h6",gutterBottom:!0,component:"p",sx:{mt:2},children:"We hope to see you soon!"})]})})]})},pe=({title:r,value:s})=>e.jsxs(x,{sx:{mb:1},children:[e.jsxs(h,{variant:"body1",component:"span",fontWeight:"bold",children:[r,":"]}),e.jsx(h,{variant:"body1",component:"span",sx:{ml:1},children:s})]}),Hs=()=>{const[r,s]=a.useState(null),[t,d]=a.useState(null),[n,i]=a.useState(!0);return a.useEffect(()=>{(async()=>{try{const u=await R.get("/api/admin/about",{withCredentials:!0});console.log("API Response:",u.data),s(u.data)}catch(u){d(u.message)}finally{i(!1)}})()},[]),n?e.jsx(ee,{}):t?e.jsxs(h,{color:"error",children:["Error: ",t]}):r?e.jsxs(x,{sx:{maxWidth:600,margin:"auto",p:3,boxShadow:3,borderRadius:2,backgroundColor:"background.paper"},children:[e.jsx(h,{variant:"h4",gutterBottom:!0,children:"About Information"}),e.jsxs(x,{sx:{p:2,mb:2,border:1,borderColor:"divider",borderRadius:2},children:[e.jsx(pe,{title:"Team",value:r.team}),e.jsx(pe,{title:"Version",value:r.version.toString()}),e.jsx(pe,{title:"Release Date",value:new Date(r.release).toLocaleDateString()}),e.jsx(pe,{title:"Product",value:r.product}),e.jsx(pe,{title:"Description",value:r.description})]})]}):e.jsx(h,{children:"No information available."})},_s=()=>{const r=Ce(),s=Dr(),{checkAuth:t}=re(),d=new URLSearchParams(s.search),n=d.get("step")==="2fa"?"2fa":"login",i=d.get("userId"),[l,u]=a.useState(n),[b,v]=a.useState(i||null),[g,c]=a.useState(!1),[o,j]=a.useState(""),[y,k]=a.useState(""),[M,I]=a.useState(""),[D,U]=a.useState(null);a.useEffect(()=>{n==="2fa"&&i&&(u("2fa"),v(i))},[n,i]);const K=async z=>{var se,ue;z.preventDefault(),c(!0),U(null);try{const N=await R.post("/api/user/login",{username:o,password:y});N.data.requiresTwoFactor?(u("2fa"),v(N.data.userId.toString()),r(`/login?step=2fa&userId=${N.data.userId}`,{replace:!0})):N.data.succeeded?(await t(),r("/dashboard")):U(N.data.message||"Login failed. Please try again.")}catch(N){U(((ue=(se=N.response)==null?void 0:se.data)==null?void 0:ue.message)||"Login failed. Please try again.")}finally{c(!1)}},xe=async z=>{var se,ue;z.preventDefault(),c(!0);try{const N=await R.post("/api/user/verify-2fa",{userId:String(b),code:M},{withCredentials:!0});N.data.succeeded?(await t(),r("/dashboard")):U(N.data.message||"Invalid 2FA code. Please try again.")}catch(N){U(((ue=(se=N.response)==null?void 0:se.data)==null?void 0:ue.message)||"2FA verification failed. Please try again.")}finally{c(!1)}};return e.jsxs(x,{component:"form",onSubmit:l==="login"?K:xe,sx:{display:"flex",flexDirection:"column",alignItems:"center",maxWidth:400,margin:"auto",padding:3,boxShadow:3,borderRadius:2,backgroundColor:"background.paper"},children:[e.jsx(h,{variant:"h4",component:"h1",gutterBottom:!0,children:l==="login"?"Login":"2FA Verification"}),D&&e.jsx(W,{severity:"error",sx:{mb:2},children:D}),l==="login"?e.jsxs(e.Fragment,{children:[e.jsx(A,{label:"Username",variant:"outlined",margin:"normal",fullWidth:!0,autoComplete:"username",value:o,onChange:z=>j(z.target.value),required:!0}),e.jsx(A,{label:"Password",type:"password",variant:"outlined",margin:"normal",fullWidth:!0,autoComplete:"current-password",value:y,onChange:z=>k(z.target.value),required:!0})]}):e.jsx(A,{label:"2FA Code",variant:"outlined",margin:"normal",fullWidth:!0,value:M,onChange:z=>I(z.target.value),required:!0}),e.jsx(T,{type:"submit",variant:"contained",color:"primary",size:"large",fullWidth:!0,sx:{mt:3,mb:2},disabled:g,children:g?e.jsx(ee,{size:24}):l==="login"?"Log In":"Verify 2FA"}),l==="login"&&e.jsxs(x,{sx:{textAlign:"center",mt:2},children:[e.jsx(Oe,{component:he,to:"/register",variant:"body2",sx:{display:"block",mb:1},children:"Don't have an account? Sign Up"}),e.jsx(Oe,{component:he,to:"/reset-password",variant:"body2",children:"Forgot Password? Click here to Reset it"})]})]})},Gs=r=>{const[s,t]=a.useState(0);return a.useEffect(()=>{t((n=>{let i=0;return n.length>=8&&(i+=1),/[A-Z]/.test(n)&&(i+=1),/[0-9]/.test(n)&&(i+=1),/[^A-Za-z0-9]/.test(n)&&(i+=1),i/4*100})(r))},[r]),s},qs=r=>r.length<8?"Password must be at least 8 characters long.":/[A-Z]/.test(r)?/[0-9]/.test(r)?/[^A-Za-z0-9]/.test(r)?null:"Password must contain at least one special character.":"Password must contain at least one number.":"Password must contain at least one uppercase letter.",Ys=()=>{const[r,s]=a.useState(""),[t,d]=a.useState(""),[n,i]=a.useState(""),[l,u]=a.useState(!1),[b,v]=a.useState(!1),[g,c]=a.useState(null),[o,j]=a.useState(null),y=Gs(n),k=Ce(),M=async D=>{var K,xe;D.preventDefault(),c(null),j(null);const U=qs(n);if(U){j(U);return}v(!0);try{const z=await R.post("/api/user/register",{username:r,email:t,password:n,enable2FA:l}),se=await R.post("/api/user/login",{username:r,password:n});z.data.requiresTwoFactor?k(`/login?step=2fa&userId=${z.data.userId}`):k("/dashboard")}catch(z){c(((xe=(K=z.response)==null?void 0:K.data)==null?void 0:xe.message)||"Registration failed. Please try again.")}finally{v(!1)}},I=D=>D<33?"error":D<66?"warning":"success";return e.jsxs(x,{component:"form",onSubmit:M,sx:{display:"flex",flexDirection:"column",alignItems:"center",maxWidth:400,margin:"auto",padding:3,boxShadow:3,borderRadius:2,backgroundColor:"background.paper"},children:[e.jsx(h,{variant:"h4",component:"h1",gutterBottom:!0,children:"Create Account"}),g&&e.jsx(W,{severity:"error",children:g}),o&&e.jsx(W,{severity:"warning",children:o}),e.jsx(A,{label:"Username",variant:"outlined",margin:"normal",fullWidth:!0,value:r,onChange:D=>s(D.target.value),required:!0}),e.jsx(A,{label:"Email",type:"email",variant:"outlined",margin:"normal",fullWidth:!0,value:t,onChange:D=>d(D.target.value),required:!0}),e.jsx(A,{label:"Password",type:"password",variant:"outlined",margin:"normal",fullWidth:!0,value:n,onChange:D=>i(D.target.value),required:!0}),e.jsxs(x,{sx:{width:"100%",mt:1},children:[e.jsx(ne,{variant:"determinate",value:y,color:I(y)}),e.jsxs(h,{variant:"body2",sx:{mt:1},children:["Password strength: ",y<33?"Weak":y<66?"Medium":"Strong"]})]}),e.jsx(ze,{control:e.jsx($e,{checked:l,onChange:D=>u(D.target.checked),color:"primary"}),label:"Enable Two-Factor Authentication (2FA)"}),e.jsx(T,{type:"submit",variant:"contained",color:"primary",size:"large",fullWidth:!0,sx:{mt:3,mb:2},disabled:b,children:b?e.jsx(ee,{size:24}):"Register"}),e.jsx(Oe,{component:he,to:"/login",variant:"body2",children:"Already have an account? Sign in"})]})},Zs=()=>{const[r,s]=a.useState({sponsorId:"",reason:""}),[t,d]=a.useState([]),[n,i]=a.useState(null),[l,u]=a.useState(null),b=a.useCallback(async()=>{try{const j=await R.get("/api/driver/available-sponsors");d(j.data),u(null)}catch{u("Failed to load sponsors. Please try again.")}},[]);a.useEffect(()=>{b()},[b]);const v=j=>{const{name:y,value:k}=j.target;s({...r,[y]:k})},g=j=>{s({...r,sponsorId:j.target.value===""?"":Number(j.target.value)})},c=async()=>{if(r.sponsorId===""){u("Please select a sponsor.");return}try{const j=await R.post("/api/driverapp/apply",r);i(j.data.message||"Application submitted successfully!"),u(null)}catch{u("Failed to submit application.")}},o=a.useMemo(()=>t.map(j=>e.jsx(S,{value:j.sponsorID,children:j.companyName},j.sponsorID)),[t]);return e.jsxs(x,{children:[e.jsx(h,{variant:"h5",children:"Driver Application"}),l&&e.jsx(W,{severity:"error",children:l}),n&&e.jsx(W,{severity:"success",children:n}),e.jsxs(G,{fullWidth:!0,margin:"normal",children:[e.jsx(q,{id:"sponsor-label",children:"Sponsor"}),e.jsx(O,{labelId:"sponsor-label",value:r.sponsorId,onChange:g,fullWidth:!0,children:o})]}),e.jsx(A,{label:"Reason for Application",name:"reason",onChange:v,fullWidth:!0,multiline:!0,margin:"normal"}),e.jsx(T,{variant:"contained",color:"primary",onClick:c,children:"Submit Application"})]})},Qs={0:"Submitted",1:"Approved",2:"Rejected"},Js=()=>{const[r,s]=a.useState([]),[t,d]=a.useState(!0),[n,i]=a.useState(null),l=async()=>{var o;try{const j=await R.get("/api/sponsor/applications");s(j.data)}catch(j){i(((o=j.response)==null?void 0:o.data)||"Failed to load applications.")}finally{d(!1)}};a.useEffect(()=>{l()},[]);const u=async(o,j)=>{var y;try{await R.post(`/api/sponsor/applications/${o}/process?action=${j}`),s(k=>k.map(M=>M.applicationID===o?{...M,status:j==="approve"?1:2}:M))}catch(k){i(((y=k.response)==null?void 0:y.data)||`Failed to ${j} application.`)}};if(t)return e.jsx(ee,{});if(n)return e.jsx(W,{severity:"error",children:n});const b=r.filter(o=>o.status===0),v=r.filter(o=>o.status===1),g=r.filter(o=>o.status===2),c=(o,j)=>o.length>0?o.map(y=>e.jsx(X,{size:{xs:12,sm:6,md:4},children:e.jsx(te,{children:e.jsxs(oe,{children:[e.jsxs(h,{variant:"subtitle1",children:["Application ID: ",y.applicationID]}),e.jsxs(h,{children:["User ID: ",y.userID]}),e.jsxs(h,{children:["Apply Date: ",y.applyDate]}),e.jsxs(h,{children:["Status: ",Qs[y.status]]}),y.status===0&&e.jsxs(e.Fragment,{children:[e.jsx(T,{color:"primary",variant:"contained",onClick:()=>u(y.applicationID,"approve"),children:"Approve"}),e.jsx(T,{color:"secondary",variant:"contained",onClick:()=>u(y.applicationID,"reject"),sx:{ml:1},children:"Reject"})]})]})})},y.applicationID)):e.jsx(h,{variant:"body2",color:"textSecondary",sx:{mt:2},children:j});return e.jsxs(we,{children:[e.jsx(h,{variant:"h4",component:"h1",gutterBottom:!0,children:"Driver Applications"}),e.jsxs(x,{children:[e.jsx(h,{variant:"h6",children:"Submitted Applications"}),e.jsx(J,{sx:{mb:2}}),e.jsx(X,{container:!0,spacing:2,style:{maxHeight:"300px",overflowY:"auto"},children:c(b,"No pending applications")})]}),e.jsxs(x,{sx:{mt:4},children:[e.jsx(h,{variant:"h6",children:"Approved Applications"}),e.jsx(J,{sx:{mb:2}}),e.jsx(X,{container:!0,spacing:2,style:{maxHeight:"300px",overflowY:"auto"},children:c(v,"No approved applications")})]}),e.jsxs(x,{sx:{mt:4},children:[e.jsx(h,{variant:"h6",children:"Rejected Applications"}),e.jsx(J,{sx:{mb:2}}),e.jsx(X,{container:!0,spacing:2,style:{maxHeight:"300px",overflowY:"auto"},children:c(g,"No rejected applications")})]})]})},Ks=(r="Driver")=>{switch(r){case"Admin":return[{check:s=>s.length>=20,message:"At least 20 characters long"},{check:s=>/[0-9]/.test(s),message:"Contains at least one digit"},{check:s=>/[a-z]/.test(s),message:"Contains at least one lowercase letter"},{check:s=>/[A-Z]/.test(s),message:"Contains at least one uppercase letter"},{check:s=>/[^A-Za-z0-9]/.test(s),message:"Contains at least three symbols"},{check:s=>new Set(s).size>=3,message:"Contains at least 3 unique characters"},{check:s=>/^(?=.*[!@#$%^&*])(?=.*[0-9])(?=.*[A-Z]).*$/.test(s),message:"Combination of numbers, symbols, and uppercase"}];case"Driver":return[{check:s=>s.length>=8,message:"At least 8 characters long"},{check:s=>/[0-9]/.test(s),message:"Contains at least one digit"},{check:s=>/[a-z]/.test(s),message:"Contains at least one lowercase letter"},{check:s=>/[A-Z]/.test(s),message:"Contains at least one uppercase letter"},{check:s=>/[^A-Za-z0-9]/.test(s),message:"Contains at least one special character"},{check:s=>new Set(s).size>=1,message:"Contains at least 1 unique character"}];default:return[{check:s=>s.length>=6,message:"At least 6 characters long"},{check:s=>/[0-9]/.test(s),message:"Contains at least one digit"},{check:s=>/[a-zA-Z]/.test(s),message:"Contains at least one letter"},{check:s=>new Set(s).size>=1,message:"Contains at least 1 unique character"}]}},wr=()=>{const[r,s]=a.useState(""),[t,d]=a.useState(""),[n,i]=a.useState(""),[l,u]=a.useState(""),[b,v]=a.useState(!1),[g,c]=a.useState(!1),[o,j]=a.useState("Driver");a.useEffect(()=>{(async()=>{try{const D=await R.get("/api/user/currentuser");j(D.data.userType)}catch(D){console.error("Error fetching user role:",D)}})()},[]);const y=Ks(o),k=I=>y.every(D=>D.check(I)),M=async I=>{var D,U;if(I.preventDefault(),u(""),v(!1),c(!0),t!==n){u("New passwords do not match"),c(!1);return}if(!k(t)){u("New password does not meet all requirements"),c(!1);return}try{const K=await R.post("/api/user/change-password",{currentPassword:r,newPassword:t});v(!0),s(""),d(""),i("")}catch(K){R.isAxiosError(K)?u(((U=(D=K.response)==null?void 0:D.data)==null?void 0:U.message)||"Failed to change password"):u("An unexpected error occurred")}finally{c(!1)}};return e.jsxs(x,{sx:{width:"100%",maxWidth:400,margin:"auto",mt:4},children:[e.jsx(h,{variant:"h4",component:"h1",gutterBottom:!0,children:"Change Password"}),l&&e.jsx(W,{severity:"error",sx:{mt:2,mb:2},children:l}),b&&e.jsx(W,{severity:"success",sx:{mt:2,mb:2},children:"Password changed successfully!"}),e.jsxs(x,{component:"form",onSubmit:M,noValidate:!0,sx:{mt:1},children:[e.jsx(A,{margin:"normal",required:!0,fullWidth:!0,name:"currentPassword",label:"Current Password",type:"password",id:"currentPassword",autoComplete:"current-password",value:r,onChange:I=>s(I.target.value)}),e.jsx(A,{margin:"normal",required:!0,fullWidth:!0,name:"newPassword",label:"New Password",type:"password",id:"newPassword",autoComplete:"new-password",value:t,onChange:I=>d(I.target.value)}),e.jsx(A,{margin:"normal",required:!0,fullWidth:!0,name:"confirmPassword",label:"Confirm New Password",type:"password",id:"confirmPassword",autoComplete:"new-password",value:n,onChange:I=>i(I.target.value)}),e.jsxs(x,{sx:{mt:4},children:[e.jsxs(h,{variant:"h6",children:["Password Requirements for ",o,":"]}),y.map((I,D)=>e.jsxs(x,{sx:{display:"flex",alignItems:"center",mt:1},children:[e.jsx(x,{sx:{flexGrow:1,mr:1},children:e.jsx(ne,{variant:"determinate",value:I.check(t)?100:0,color:I.check(t)?"success":"error"})}),e.jsx(x,{sx:{minWidth:200},children:e.jsx(h,{variant:"body2",color:"text.secondary",children:I.message})})]},D))]}),e.jsx(T,{type:"submit",fullWidth:!0,variant:"contained",sx:{mt:3,mb:2},disabled:g,children:g?e.jsx(ee,{size:24}):"Change Password"})]})]})},Xs=()=>{const[r,s]=a.useState([]),[t,d]=a.useState(""),[n,i]=a.useState(!0),[l,u]=a.useState("");a.useEffect(()=>{b()},[]);const b=async()=>{try{i(!0);const c=await R.get("/api/driver/my-sponsors");s(c.data),c.data.length>0&&!t&&d(c.data[0].sponsorId),u("")}catch(c){u("Failed to load sponsor points data"),console.error("Error fetching sponsor points:",c)}finally{i(!1)}},v=c=>{d(c.target.value)};if(n)return e.jsx(x,{sx:{width:"100%",mt:2},children:e.jsx(ne,{})});if(l)return e.jsx(h,{color:"error",sx:{mt:2},children:l});if(r.length===0)return e.jsx(h,{sx:{mt:2},children:"You are not currently registered with any sponsors."});const g=r.find(c=>c.sponsorId===t);return e.jsxs(x,{sx:{width:"100%",mb:2,mt:2},children:[e.jsxs(G,{fullWidth:!0,sx:{mb:2},children:[e.jsx(q,{children:"Select Sponsor"}),e.jsx(O,{value:t,label:"Select Sponsor",onChange:v,children:r.map(c=>e.jsx(S,{value:c.sponsorId,children:c.sponsorName},c.sponsorId))})]}),g&&e.jsx(ae,{children:e.jsx(ie,{children:e.jsxs(le,{"aria-label":"sponsor points details",children:[e.jsx(ce,{children:e.jsxs(L,{children:[e.jsx(m,{children:"Sponsor"}),e.jsx(m,{align:"right",children:"Total Points"}),e.jsx(m,{align:"right",children:"Point Value ($)"}),e.jsx(m,{align:"right",children:"Total Value ($)"})]})}),e.jsx(de,{children:e.jsxs(L,{children:[e.jsx(m,{children:g.sponsorName}),e.jsx(m,{align:"right",children:g.totalPoints.toLocaleString()}),e.jsxs(m,{align:"right",children:["$",g.pointDollarValue.toFixed(2)]}),e.jsxs(m,{align:"right",children:["$",(g.totalPoints*g.pointDollarValue).toFixed(2)]})]})})]})})})]})},et=()=>{const[r,s]=a.useState(null),[t,d]=a.useState(!0),[n,i]=a.useState("");return a.useEffect(()=>{(async()=>{try{d(!0);const u=await R.get("/api/driver/activity");s(u.data)}catch(u){i("Failed to load driver activity"),console.error("Error fetching activity:",u)}finally{d(!1)}})()},[]),t?e.jsx(ne,{}):n?e.jsx(h,{color:"error",children:n}):r?e.jsxs(x,{sx:{p:3},children:[r.pointValue&&e.jsx(te,{sx:{mb:4},children:e.jsxs(oe,{children:[e.jsxs(h,{variant:"h6",gutterBottom:!0,children:["Points Value - ",r.pointValue.sponsorName||"Unknown Sponsor"]}),e.jsxs(h,{children:["Current Balance: ",r.pointValue.totalPoints.toLocaleString()," points"]}),e.jsxs(h,{children:["Point Value: $",r.pointValue.pointValue.toFixed(2)," each"]}),e.jsxs(h,{variant:"h5",sx:{mt:2},children:["Total Value: $",r.pointValue.totalValue.toFixed(2)]})]})}),e.jsx(h,{variant:"h6",gutterBottom:!0,children:"Activity History"}),e.jsx(ie,{component:ae,children:e.jsxs(le,{children:[e.jsx(ce,{children:e.jsxs(L,{children:[e.jsx(m,{children:"Date"}),e.jsx(m,{children:"Type"}),e.jsx(m,{children:"Points"}),e.jsx(m,{children:"Details"}),e.jsx(m,{children:"Status"})]})}),e.jsx(de,{children:r.transactions&&r.transactions.length>0?r.transactions.map((l,u)=>e.jsxs(L,{children:[e.jsx(m,{children:l.date?new Date(l.date).toLocaleDateString():"N/A"}),e.jsx(m,{children:l.type}),e.jsxs(m,{sx:{color:l.points>0?"success.main":"error.main"},children:[l.points>0?"+":"",l.points]}),e.jsx(m,{children:l.reason}),e.jsx(m,{children:l.status&&e.jsx(be,{label:l.status,color:l.status==="Ordered"?"success":l.status==="Cancelled"?"error":"default",size:"small"})})]},u)):e.jsx(L,{children:e.jsx(m,{colSpan:5,align:"center",children:"No transactions available"})})})]})})]}):null};function tr({icon:r,title:s,value:t,description:d}){return e.jsx(te,{sx:{height:"100%"},children:e.jsxs(oe,{children:[e.jsx(r,{sx:{color:"primary.main",mb:1}}),e.jsx(h,{component:"h2",variant:"subtitle2",sx:{fontWeight:"600",mb:1},children:s}),e.jsx(h,{variant:"h4",sx:{mb:1},children:t}),e.jsx(h,{sx:{color:"text.secondary",mb:1},children:d})]})})}function rt(){const r=Le(),s=as(r.breakpoints.down("sm")),[t,d]=a.useState([]),[n,i]=a.useState(!0),[l,u]=a.useState(null);if(a.useEffect(()=>{(async()=>{try{const g=await fetch("/api/sponsor/drivers",{credentials:"include"});if(!g.ok)throw new Error("Failed to fetch drivers");const c=await g.json();d(c)}catch(g){u(g instanceof Error?g.message:"An error occurred while fetching drivers")}finally{i(!1)}})()},[]),n)return e.jsx(x,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:400,children:e.jsx(ee,{})});if(l)return e.jsx(W,{severity:"error",sx:{mb:2},children:l});const b=t.reduce((v,g)=>v+g.totalPoints,0);return e.jsxs(x,{sx:{width:"100%"},children:[e.jsx(h,{component:"h2",variant:"h6",sx:{mb:2},children:"Sponsored Drivers Overview"}),e.jsxs(X,{container:!0,spacing:2,columns:12,children:[e.jsx(X,{size:{xs:12,lg:9},children:e.jsx(te,{sx:{height:"100%"},children:e.jsxs(oe,{children:[t.length===0?e.jsx(x,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:200,children:e.jsx(h,{color:"text.secondary",children:"No drivers found under your sponsorship."})}):e.jsx(ie,{children:e.jsxs(le,{sx:{minWidth:650},children:[e.jsx(ce,{children:e.jsxs(L,{children:[e.jsx(m,{children:"Driver ID"}),e.jsx(m,{children:"Email"}),e.jsx(m,{align:"right",children:"Total Points"})]})}),e.jsx(de,{children:t.map(v=>e.jsxs(L,{children:[e.jsx(m,{component:"th",scope:"row",children:v.userID}),e.jsx(m,{children:v.email}),e.jsx(m,{align:"right",children:v.totalPoints.toLocaleString()})]},v.userID))})]})}),e.jsx(x,{sx:{mt:2,display:"flex",justifyContent:"flex-end"},children:e.jsx(T,{variant:"contained",size:"small",color:"primary",endIcon:e.jsx(Ze,{}),fullWidth:s,children:"View All Drivers"})})]})})}),e.jsx(X,{size:{xs:12,lg:3},children:e.jsxs(B,{gap:2,direction:{xs:"column",sm:"row",lg:"column"},children:[e.jsx(tr,{icon:Qe,title:"Active Drivers",value:t.length.toString(),description:"Currently sponsored drivers"}),e.jsx(tr,{icon:ns,title:"Total Points",value:b.toLocaleString(),description:"Accumulated driver points"})]})})]}),e.jsx(h,{component:"h2",variant:"h6",sx:{mb:2,mt:4},children:"Driver Management"}),e.jsx(X,{container:!0,spacing:2,columns:12,children:e.jsx(X,{size:{xs:12,sm:6,lg:4},children:e.jsx(te,{sx:{height:"100%"},children:e.jsxs(oe,{children:[e.jsx(Qe,{sx:{color:"primary.main",mb:1}}),e.jsx(h,{component:"h2",variant:"subtitle2",sx:{fontWeight:"600"},children:"Manage Drivers"}),e.jsx(h,{sx:{color:"text.secondary",mb:2},children:"Add or remove drivers from your sponsorship."}),e.jsx(T,{variant:"contained",size:"small",color:"primary",endIcon:e.jsx(Ze,{}),fullWidth:s,children:"Manage Drivers"})]})})})})]})}const st=()=>{const[r,s]=a.useState([]),[t,d]=a.useState([]),[n,i]=a.useState(!0),[l,u]=a.useState(null),[b,v]=a.useState(null),[g,c]=a.useState(!1);a.useEffect(()=>{o()},[]);const o=async()=>{var k,M;try{const I=await R.get("/api/driver/available-sponsors",{withCredentials:!0});s(Array.isArray(I.data)?I.data:[]),console.log("Sponsors response:",I.data)}catch(I){if(R.isAxiosError(I)){const D=((k=I.response)==null?void 0:k.data)||"Error loading sponsors. Please try again later.";u(typeof D=="string"?D:"An error occurred."),console.error("Axios error:",(M=I.response)==null?void 0:M.data)}else u("Error loading sponsors. Please try again later."),console.error("Error:",I);s([])}finally{i(!1)}},j=k=>{d(M=>M.includes(k)?M.filter(I=>I!==k):[...M,k])},y=async()=>{var k,M;if(t.length===0){u("Please select at least one sponsor");return}c(!0),u(null),v(null);try{const I=await R.post("/api/driver/register-sponsors",t,{withCredentials:!0,headers:{"Content-Type":"application/json"}});v(I.data||"Successfully registered with selected sponsors!"),d([]),o()}catch(I){if(R.isAxiosError(I)){const D=((k=I.response)==null?void 0:k.data)||"Failed to register with sponsors. Please try again.";u(typeof D=="string"?D:"Registration failed."),console.error("Axios error:",(M=I.response)==null?void 0:M.data)}else u("Failed to register with sponsors. Please try again."),console.error("Error:",I)}finally{c(!1)}};return n?e.jsx(x,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"200px",children:e.jsx(ee,{})}):e.jsxs(x,{sx:{maxWidth:800,mx:"auto",p:2},children:[e.jsx(h,{variant:"h5",component:"h1",gutterBottom:!0,children:"Select Sponsors"}),e.jsx(te,{sx:{mb:2,bgcolor:"background.paper"},children:e.jsxs(oe,{children:[e.jsxs(B,{direction:"row",alignItems:"center",spacing:1,sx:{mb:2},children:[e.jsx(h,{variant:"subtitle1",children:"Available Reward Programs"}),e.jsx(gr,{title:"Select multiple sponsors to join their reward programs",children:e.jsx(is,{color:"action",fontSize:"small"})})]}),l&&e.jsx(W,{severity:"error",sx:{mb:2},children:l}),b&&e.jsx(W,{severity:"success",sx:{mb:2},children:b}),e.jsx(ls,{children:r.length===0?e.jsx(h,{color:"text.secondary",children:"No available sponsors found."}):r.map(k=>e.jsxs(x,{sx:{mb:2},children:[e.jsx(ze,{control:e.jsx($e,{checked:t.includes(k.sponsorID),onChange:()=>j(k.sponsorID),color:"primary"}),label:e.jsxs(B,{direction:"row",spacing:2,alignItems:"center",children:[e.jsx(cs,{color:"action"}),e.jsx(h,{children:k.companyName}),e.jsx(be,{icon:e.jsx(ds,{}),label:`$${k.pointDollarValue} per point`,size:"small",color:"primary",variant:"outlined"})]})}),e.jsx(J,{sx:{ml:7,my:1}})]},k.sponsorID))}),e.jsx(T,{variant:"contained",color:"primary",onClick:y,disabled:t.length===0||g,sx:{mt:2},children:g?e.jsx(ee,{size:24,color:"inherit"}):`Register with ${t.length} Sponsor${t.length!==1?"s":""}`})]})})]})},tt=()=>{const{driverId:r}=Rr(),[s,t]=a.useState([]),[d,n]=a.useState(!0),[i,l]=a.useState("");return a.useEffect(()=>{(async()=>{try{n(!0);const b=await R.get("/api/driver/transactions");t(b.data),l("")}catch(b){l("Failed to load transaction data"),console.error("Error fetching transactions:",b)}finally{n(!1)}})()},[r]),d?e.jsx(x,{sx:{width:"100%",mt:2},children:e.jsx(ne,{})}):i?e.jsx(h,{color:"error",sx:{mt:2},children:i}):e.jsx(ae,{sx:{width:"100%",mb:2,mt:2},children:e.jsx(ie,{children:e.jsxs(le,{"aria-label":"driver transactions table",children:[e.jsx(ce,{children:e.jsxs(L,{children:[e.jsx(m,{children:"Date"}),e.jsx(m,{children:"Points Changed"}),e.jsx(m,{children:"Reason"})]})}),e.jsx(de,{children:s.map(u=>e.jsxs(L,{children:[e.jsx(m,{children:new Date(u.transactionDate).toLocaleDateString()}),e.jsx(m,{children:u.pointsChanged}),e.jsx(m,{children:u.reason})]},u.transactionId))})]})})})},Ir=({dateRange:r,setDateRange:s})=>{const[t,d]=r,[n,i]=a.useState(!1),l=u=>{const b=new Date,v=new Date;v.setDate(b.getDate()-u),s([v,b])};return e.jsx(us,{dateAdapter:ps,children:e.jsxs(B,{direction:"column",spacing:2,alignItems:"flex-start",sx:{mb:2},children:[e.jsx(ze,{control:e.jsx($e,{checked:n,onChange:()=>i(!n)}),label:"Custom Date Range"}),n?e.jsxs(B,{direction:"row",spacing:2,alignItems:"center",children:[e.jsxs(x,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(Je,{fontSize:"small"}),e.jsx(Ke,{label:"Start",value:t,onChange:u=>s([u,d]),disableFuture:!0})]}),e.jsxs(x,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(Je,{fontSize:"small"}),e.jsx(Ke,{label:"End",value:d,onChange:u=>s([t,u]),disableFuture:!0})]})]}):e.jsxs(B,{direction:"row",spacing:1,children:[e.jsx(T,{variant:"outlined",size:"small",onClick:()=>l(7),children:"Last 7 Days"}),e.jsx(T,{variant:"outlined",size:"small",onClick:()=>l(30),children:"Last 30 Days"}),e.jsx(T,{variant:"outlined",size:"small",onClick:()=>l(365),children:"Last Year"})]})]})})};function kr({reportType:r,viewType:s,selectedSponsor:t,selectedDriver:d,dateRange:n}){const i=Le(),[l,u]=a.useState([]),[b,v]=a.useState([]);a.useEffect(()=>{const j=(()=>{switch(r){case"salesBySponsor":return s==="detailed"?[{date:"Date 1",driver1:100,driver2:150,driver3:200},{date:"Date 2",driver1:120,driver2:140,driver3:210},{date:"Date 3",driver1:130,driver2:160,driver3:220}]:[{sponsor:"Sponsor A",totalPoints:450},{sponsor:"Sponsor B",totalPoints:470},{sponsor:"Sponsor C",totalPoints:510}];case"salesByDriver":return s==="detailed"?[{date:"Date 1",driver1:50,driver2:75,driver3:90},{date:"Date 2",driver1:60,driver2:80,driver3:95},{date:"Date 3",driver1:70,driver2:85,driver3:100}]:[{driver:"Driver 1",totalPoints:250},{driver:"Driver 2",totalPoints:240},{driver:"Driver 3",totalPoints:260}];case"invoice":return[{driver:"Driver 1",redeemedPoints:120,fee:10},{driver:"Driver 2",redeemedPoints:150,fee:15},{driver:"Driver 3",redeemedPoints:180,fee:20}];case"driverPoints":return s==="detailed"?[{date:"Date 1",pointEarned:50,pointRedeemed:20},{date:"Date 2",pointEarned:70,pointRedeemed:30},{date:"Date 3",pointEarned:60,pointRedeemed:25}]:[{driver:"Driver 1",totalPoints:150},{driver:"Driver 2",totalPoints:170},{driver:"Driver 3",totalPoints:140}];default:return[]}})();u(j),v(j.map(y=>y.date||y.sponsor||y.driver))},[r,s,t,d,n]);const g=()=>e.jsx(hs,{xAxis:[{data:b,scaleType:"band"}],series:s==="detailed"&&(r==="salesBySponsor"||r==="salesByDriver")?[{data:l.map(o=>o.driver1||0),label:"Driver 1",stack:"drivers",color:i.palette.primary.light},{data:l.map(o=>o.driver2||0),label:"Driver 2",stack:"drivers",color:i.palette.primary.main},{data:l.map(o=>o.driver3||0),label:"Driver 3",stack:"drivers",color:i.palette.primary.dark}]:s==="detailed"&&r==="driverPoints"?[{data:l.map(o=>o.pointEarned||0),label:"Points Earned",color:i.palette.success.main},{data:l.map(o=>o.pointRedeemed||0),label:"Points Redeemed",color:i.palette.error.main}]:[{data:l.map(o=>o.totalPoints),label:r==="salesBySponsor"?"Total Sales by Sponsor":"Total Sales by Driver",color:i.palette.primary.main}],height:300,grid:{horizontal:!0}}),c=()=>e.jsx(xs,{series:[{data:l.map(o=>({id:o.driver,value:o.redeemedPoints,label:o.driver,color:i.palette.primary.main}))}],height:300});return e.jsx("div",{children:r==="invoice"?c():g()})}function ot(){const[r,s]=a.useState("driverPoints"),[t,d]=a.useState("summary"),[n,i]=a.useState("all"),[l,u]=a.useState([null,null]);return e.jsxs(x,{children:[e.jsx(h,{variant:"h5",sx:{mb:2},"aria-label":"Sponsor Reports Dashboard",children:"Sponsor Reports Dashboard"}),e.jsxs(B,{direction:"row",spacing:2,alignItems:"center",sx:{mb:3,flexWrap:"wrap",gap:2},children:[e.jsxs(G,{sx:{minWidth:180},children:[e.jsx(q,{id:"report-type-label",children:"Report Type"}),e.jsx(O,{labelId:"report-type-label",value:r,onChange:b=>s(b.target.value),label:"Report Type","aria-label":"Select Report Type for Sponsor",children:e.jsx(S,{value:"driverPoints",children:"Driver Points Tracking"})})]}),e.jsxs(G,{sx:{minWidth:180},children:[e.jsx(q,{id:"view-type-label",children:"View Type"}),e.jsxs(O,{labelId:"view-type-label",value:t,onChange:b=>d(b.target.value),label:"View Type","aria-label":"Select View Type for Sponsor",children:[e.jsx(S,{value:"summary",children:"Summary"}),e.jsx(S,{value:"detailed",children:"Detailed"})]})]}),e.jsxs(G,{sx:{minWidth:180},children:[e.jsx(q,{id:"select-driver-label",children:"Select Driver"}),e.jsxs(O,{labelId:"select-driver-label",value:n,onChange:b=>i(b.target.value),label:"Select Driver","aria-label":"Select Driver for Driver Points Tracking",children:[e.jsx(S,{value:"all",children:"All Drivers"}),e.jsx(S,{value:1,children:"Driver 1"}),e.jsx(S,{value:2,children:"Driver 2"})]})]})]}),e.jsx(Ir,{dateRange:l,setDateRange:u}),e.jsx(x,{sx:{mt:4},children:e.jsx(kr,{reportType:r,viewType:t,selectedDriver:n,dateRange:l,"aria-label":"Sponsor Report Chart"})})]})}function at(){const[r,s]=a.useState("salesBySponsor"),[t,d]=a.useState("summary"),[n,i]=a.useState([null,null]),[l,u]=a.useState("all"),[b,v]=a.useState("all"),g=r==="salesByDriver"&&l!=="all";return e.jsxs(x,{children:[e.jsx(h,{variant:"h5",sx:{mb:2},"aria-label":"Admin Reports Dashboard",children:"Admin Reports Dashboard"}),e.jsxs(B,{direction:"row",spacing:2,alignItems:"center",sx:{mb:3,flexWrap:"wrap",gap:2},children:[e.jsxs(G,{sx:{minWidth:180},children:[e.jsx(q,{id:"report-type-label",children:"Report Type"}),e.jsxs(O,{labelId:"report-type-label",value:r,onChange:c=>s(c.target.value),label:"Report Type","aria-label":"Select Report Type",children:[e.jsx(S,{value:"salesBySponsor",children:"Sales by Sponsor"}),e.jsx(S,{value:"salesByDriver",children:"Sales by Driver"}),e.jsx(S,{value:"invoice",children:"Invoice Report"})]})]}),e.jsxs(G,{sx:{minWidth:180},children:[e.jsx(q,{id:"view-type-label",children:"View Type"}),e.jsxs(O,{labelId:"view-type-label",value:t,onChange:c=>d(c.target.value),label:"View Type","aria-label":"Select View Type",children:[e.jsx(S,{value:"summary",children:"Summary"}),e.jsx(S,{value:"detailed",children:"Detailed"})]})]}),(r==="salesBySponsor"||r==="invoice")&&e.jsxs(G,{sx:{minWidth:180},children:[e.jsx(q,{id:"select-sponsor-label",children:"Select Sponsor"}),e.jsxs(O,{labelId:"select-sponsor-label",value:l,onChange:c=>u(c.target.value),label:"Select Sponsor","aria-label":"Select Sponsor",children:[e.jsx(S,{value:"all",children:"All Sponsors"}),e.jsx(S,{value:101,children:"Sponsor A"}),e.jsx(S,{value:102,children:"Sponsor B"})]})]}),r==="salesByDriver"&&e.jsxs(e.Fragment,{children:[e.jsxs(G,{sx:{minWidth:180},children:[e.jsx(q,{id:"select-sponsor-label",children:"Select Sponsor"}),e.jsxs(O,{labelId:"select-sponsor-label",value:l,onChange:c=>u(c.target.value),label:"Select Sponsor","aria-label":"Select Sponsor for Sales by Driver",children:[e.jsx(S,{value:"all",children:"All Sponsors"}),e.jsx(S,{value:101,children:"Sponsor A"}),e.jsx(S,{value:102,children:"Sponsor B"})]})]}),g&&e.jsxs(G,{sx:{minWidth:180},children:[e.jsx(q,{id:"select-driver-label",children:"Select Driver"}),e.jsxs(O,{labelId:"select-driver-label",value:b,onChange:c=>v(c.target.value),label:"Select Driver","aria-label":"Select Driver for Individual Sponsor",children:[e.jsx(S,{value:"all",children:"All Drivers"}),e.jsx(S,{value:1,children:"Driver 1"}),e.jsx(S,{value:2,children:"Driver 2"})]})]})]})]}),e.jsx(Ir,{dateRange:n,setDateRange:i}),e.jsx(x,{sx:{mt:4},children:e.jsx(kr,{reportType:r,viewType:t,selectedSponsor:l,selectedDriver:b,dateRange:n,"aria-label":"Admin Report Chart"})})]})}const nt=()=>{const[r,s]=a.useState([]),[t,d]=a.useState(!0),[n,i]=a.useState(""),[l,u]=a.useState("");a.useEffect(()=>{b()},[]);const b=async()=>{try{d(!0);const o=await R.get("/api/admin/drivers/details");s(o.data),i("")}catch(o){i("Failed to load driver data"),console.error("Error fetching drivers:",o)}finally{d(!1)}},v=async(o,j)=>{try{await R.post("/api/user/change-user-type",{userId:o,newUserType:j}),await b()}catch(y){i(y.message)}},g=async o=>{try{await R.delete(`/api/user/delete-user/${o}`),await b()}catch(j){i(j.message)}},c=Array.isArray(r)?r.filter(o=>o.name.toLowerCase().includes(l.toLowerCase())||o.email.toLowerCase().includes(l.toLowerCase())||o.sponsorRelationships.some(j=>j.sponsorName.toLowerCase().includes(l.toLowerCase()))):[];return t?e.jsx(x,{sx:{width:"100%",mt:2},children:e.jsx(ne,{})}):n?e.jsx(W,{severity:"error",sx:{mt:2},children:n}):e.jsxs(x,{sx:{width:"100%",p:3},children:[e.jsx(h,{variant:"h5",gutterBottom:!0,children:"Driver-Sponsor Associations"}),e.jsxs(x,{sx:{display:"flex",alignItems:"center",mb:3},children:[e.jsx(A,{fullWidth:!0,variant:"outlined",placeholder:"Search by driver name, email, or sponsor...",value:l,onChange:o=>u(o.target.value)}),e.jsx(Y,{sx:{ml:-4},children:e.jsx(Ne,{})})]}),e.jsx(ie,{component:ae,children:e.jsxs(le,{children:[e.jsx(ce,{children:e.jsxs(L,{children:[e.jsx(m,{children:"Driver Name"}),e.jsx(m,{children:"Email"}),e.jsx(m,{children:"Sponsors"}),e.jsx(m,{align:"center",children:"Total Sponsors"}),e.jsx(m,{children:"Points Distribution"}),e.jsx(m,{children:"User Type"}),e.jsx(m,{children:"Actions"})]})}),e.jsx(de,{children:c.map(o=>e.jsxs(L,{children:[e.jsx(m,{children:o.name}),e.jsx(m,{children:o.email}),e.jsx(m,{children:e.jsx(x,{sx:{display:"flex",gap:1,flexWrap:"wrap"},children:o.sponsorRelationships.map(j=>e.jsx(be,{label:j.sponsorName,size:"small",color:"primary"},j.sponsorId))})}),e.jsx(m,{align:"center",children:o.sponsorRelationships.length}),e.jsx(m,{children:e.jsx(x,{sx:{display:"flex",alignItems:"center",gap:1},children:o.sponsorRelationships.map(j=>e.jsx(gr,{title:`${j.sponsorName}: ${j.points} points`,children:e.jsx(x,{sx:{display:"flex",alignItems:"center"},children:e.jsx(h,{variant:"body2",children:j.points})})},j.sponsorId))})}),e.jsx(m,{children:e.jsxs(O,{size:"small",value:o.userType||"",onChange:j=>v(o.userId.toString(),j.target.value),children:[e.jsx(S,{value:"driver",children:"Driver"}),e.jsx(S,{value:"sponsor",children:"Sponsor"}),e.jsx(S,{value:"admin",children:"Admin"})]})}),e.jsx(m,{children:e.jsx(Y,{onClick:()=>g(o.userId.toString()),color:"error",size:"small",children:e.jsx(Ve,{})})})]},o.userId))})]})})]})},Ae={1:"User",2:"Point",3:"Purchase",4:"Application",5:"Product",6:"System"},Pe=[{logID:1,userID:1,category:1,description:"Admin User logged in",timestamp:"2024-11-06T14:23:30Z"},{logID:2,userID:10,category:2,description:"Points added to DriverTR1",timestamp:"2024-11-06T14:50:00Z"},{logID:3,userID:10,category:3,description:"DriverTR1 purchased glasses",timestamp:"2024-11-06T15:10:00Z"},{logID:4,userID:10,category:4,description:"Applied for sponsorship with Speedy Stats",timestamp:"2024-11-06T15:10:00Z"},{logID:5,userID:1,category:5,description:"New Product Added to catalog",timestamp:"2024-11-06T15:10:00Z"},{logID:6,userID:1,category:6,description:"System back up complete",timestamp:"2024-11-06T15:10:00Z"}],it=()=>{var g;const[r,s]=a.useState(Pe);a.useState(Pe.length);const[t,d]=a.useState({page:0,pageSize:10}),n=(c,o)=>{d(j=>({...j,page:o}))},i=c=>{d(o=>({...o,pageSize:parseInt(c.target.value,10),page:0}))},l=c=>{const o=c.target.value===""?void 0:parseInt(c.target.value);d(j=>({...j,category:o,page:0}))},u=c=>Ae[c]||"Unknown",b=r.filter(c=>{const o=t.userID?c.userID===t.userID:!0,j=t.category?c.category===t.category:!0,y=t.searchTerm?c.description.toLowerCase().includes(t.searchTerm.toLowerCase()):!0;return o&&j&&y}),v=b.slice(t.page*t.pageSize,(t.page+1)*t.pageSize);return e.jsx(x,{sx:{p:3},children:e.jsxs(P,{container:!0,spacing:3,children:[e.jsx(P,{item:!0,xs:12,children:e.jsx(h,{variant:"h4",gutterBottom:!0,children:"Audit Log Dashboard"})}),e.jsx(P,{item:!0,xs:12,children:e.jsx(ae,{sx:{p:2,mb:2},children:e.jsxs(P,{container:!0,spacing:2,alignItems:"center",children:[e.jsx(P,{item:!0,xs:12,sm:6,md:3,children:e.jsx(A,{fullWidth:!0,label:"User ID",type:"number",value:t.userID||"",onChange:c=>d(o=>({...o,userID:c.target.value?parseInt(c.target.value):void 0,page:0}))})}),e.jsx(P,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(G,{fullWidth:!0,children:[e.jsx(q,{children:"Category"}),e.jsxs(O,{value:((g=t.category)==null?void 0:g.toString())||"",label:"Category",onChange:l,children:[e.jsx(S,{value:"",children:"All"}),Object.keys(Ae).map(c=>e.jsx(S,{value:c,children:Ae[parseInt(c)]},c))]})]})}),e.jsx(P,{item:!0,xs:12,children:e.jsx(A,{fullWidth:!0,label:"Search Description",value:t.searchTerm||"",onChange:c=>d(o=>({...o,searchTerm:c.target.value||void 0,page:0}))})})]})})}),e.jsx(P,{item:!0,xs:12,children:e.jsxs(ae,{children:[e.jsx(x,{sx:{display:"flex",justifyContent:"flex-end",p:2},children:e.jsx(Y,{onClick:()=>s([...Pe]),children:e.jsx(gs,{})})}),e.jsx(ie,{children:e.jsxs(le,{children:[e.jsx(ce,{children:e.jsxs(L,{children:[e.jsx(m,{children:"Log ID"}),e.jsx(m,{children:"User ID"}),e.jsx(m,{children:"Category"}),e.jsx(m,{children:"Description"}),e.jsx(m,{children:"Timestamp"})]})}),e.jsx(de,{children:v.map(c=>e.jsxs(L,{children:[e.jsx(m,{children:c.logID}),e.jsx(m,{children:c.userID}),e.jsx(m,{children:e.jsx(be,{label:u(c.category),size:"small",color:lt(c.category)})}),e.jsx(m,{children:c.description}),e.jsx(m,{children:Ar(new Date(c.timestamp),"MMM dd, yyyy HH:mm:ss")})]},c.logID))})]})}),e.jsx(ms,{component:"div",count:b.length,page:t.page,onPageChange:n,rowsPerPage:t.pageSize,onRowsPerPageChange:i,rowsPerPageOptions:[5,10,25,50]})]})})]})})},lt=r=>({0:"primary",1:"secondary",2:"success",3:"info",4:"warning",5:"error"})[r]||"default",me={Driver:0,Sponsor:1,Admin:2},ct=({open:r,onClose:s})=>{const[t,d]=a.useState({Username:"",Email:"",Password:"",UserType:me.Admin,CompanyName:"",SponsorType:"",PointDollarValue:.01,SponsorID:""}),n=l=>{const{name:u,value:b}=l.target;d(u==="UserType"?v=>({...v,[u]:me[b]}):v=>({...v,[u]:u==="SponsorID"?b===""?"":parseInt(b):b}))},i=async l=>{var b,v;l.preventDefault();const u={...t,CompanyName:t.CompanyName||null,SponsorType:t.SponsorType||null,PointDollarValue:t.PointDollarValue||null,SponsorID:t.SponsorID===""?null:parseInt(t.SponsorID)};try{const g=await R.post("/api/admin/create-user",u,{headers:{"Content-Type":"application/json"}});alert("User created successfully"),s(),d({Username:"",Email:"",Password:"",UserType:"Admin",CompanyName:"",SponsorType:"",PointDollarValue:.01,SponsorID:""})}catch(g){console.error("Error creating user:",g);const c=((v=(b=g.response)==null?void 0:b.data)==null?void 0:v.details)||"Failed to create user";alert(c)}};return e.jsx(js,{open:r,onClose:s,"aria-labelledby":"create-user-modal-title","aria-describedby":"create-user-modal-description",sx:{display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"rgba(0, 0, 0, 0.5)"},children:e.jsxs(x,{sx:{backgroundColor:"white",padding:4,borderRadius:2,width:"100%",maxWidth:400},children:[e.jsx(h,{id:"create-user-modal-title",variant:"h6",component:"h2",children:"Create New User"}),e.jsxs("form",{onSubmit:i,children:[e.jsx(x,{sx:{mb:2},children:e.jsx(A,{label:"Username",name:"Username",value:t.Username,onChange:n,required:!0,fullWidth:!0})}),e.jsx(x,{sx:{mb:2},children:e.jsx(A,{label:"Email",name:"Email",type:"email",value:t.Email,onChange:n,required:!0,fullWidth:!0})}),e.jsx(x,{sx:{mb:2},children:e.jsx(A,{label:"Password",name:"Password",type:"password",value:t.Password,onChange:n,required:!0,fullWidth:!0})}),e.jsx(x,{sx:{mb:2},children:e.jsxs(G,{fullWidth:!0,children:[e.jsx(q,{id:"user-type-label",children:"User Type"}),e.jsxs(O,{labelId:"user-type-label",name:"UserType",value:Object.keys(me).find(l=>me[l]===t.UserType),onChange:n,required:!0,children:[e.jsx(S,{value:"Admin",children:"Admin"}),e.jsx(S,{value:"Sponsor",children:"Sponsor"}),e.jsx(S,{value:"Driver",children:"Driver"})]})]})}),t.UserType===me.Sponsor&&e.jsxs(e.Fragment,{children:[e.jsx(x,{sx:{mb:2},children:e.jsx(A,{label:"Company Name",name:"CompanyName",value:t.CompanyName,onChange:n,required:!0,fullWidth:!0})}),e.jsx(x,{sx:{mb:2},children:e.jsx(A,{label:"Sponsor Type",name:"SponsorType",value:t.SponsorType,onChange:n,required:!0,fullWidth:!0})}),e.jsx(x,{sx:{mb:2},children:e.jsx(A,{label:"Point Dollar Value",name:"PointDollarValue",type:"number",step:"0.01",value:t.PointDollarValue,onChange:n,required:!0,fullWidth:!0})})]}),t.UserType===me.Driver&&e.jsx(x,{sx:{mb:2},children:e.jsx(A,{label:"Sponsor ID",name:"SponsorID",type:"number",value:t.SponsorID,onChange:n,required:!0,fullWidth:!0})}),e.jsx(T,{type:"submit",variant:"contained",color:"primary",fullWidth:!0,children:"Create User"})]})]})})},dt=()=>{const[r,s]=a.useState([]),[t,d]=a.useState(!0),[n,i]=a.useState(""),[l,u]=a.useState(""),[b,v]=a.useState(!1);a.useEffect(()=>{g()},[]);const g=async()=>{try{d(!0);const y=await R.get("/api/admin/admins/details");s(y.data),i("")}catch(y){i("Failed to load admin data"),console.error("Error fetching admins:",y)}finally{d(!1)}},c=async(y,k)=>{try{await R.post("/api/user/change-user-type",{userId:y,newUserType:k}),await g()}catch(M){i(M.message)}},o=async y=>{try{await R.delete(`/api/user/remove-user/${y}`),await g()}catch(k){i(k.message)}},j=r.filter(y=>y.name.toLowerCase().includes(l.toLowerCase())||y.email.toLowerCase().includes(l.toLowerCase()));return t?e.jsx(x,{sx:{width:"100%",mt:2},children:e.jsx(ne,{})}):n?e.jsx(W,{severity:"error",sx:{mt:2},children:n}):e.jsxs(x,{sx:{width:"100%",p:3},children:[e.jsx(h,{variant:"h5",gutterBottom:!0,children:"Manage Administrators"}),e.jsxs(x,{sx:{display:"flex",alignItems:"center",mb:3},children:[e.jsx(A,{fullWidth:!0,variant:"outlined",placeholder:"Search admins by name or email...",value:l,onChange:y=>u(y.target.value),InputProps:{endAdornment:e.jsx(Y,{children:e.jsx(Ne,{})})}}),e.jsx(T,{variant:"contained",color:"primary",onClick:()=>v(!0),sx:{ml:2},children:"Create User"})]}),b&&e.jsx(ct,{open:b,onClose:()=>v(!1)}),e.jsx(ie,{component:ae,children:e.jsxs(le,{children:[e.jsx(ce,{children:e.jsxs(L,{children:[e.jsx(m,{children:"Name"}),e.jsx(m,{children:"Email"}),e.jsx(m,{children:"Created At"}),e.jsx(m,{children:"Last Login"}),e.jsx(m,{children:"User Type"}),e.jsx(m,{children:"Actions"})]})}),e.jsx(de,{children:j.map(y=>e.jsxs(L,{children:[e.jsx(m,{children:y.name}),e.jsx(m,{children:y.email}),e.jsx(m,{children:new Date(y.createdAt).toLocaleDateString()}),e.jsx(m,{children:new Date(y.lastLogin).toLocaleDateString()}),e.jsx(m,{children:e.jsxs(O,{size:"small",value:y.userType||"admin",onChange:k=>c(y.userId.toString(),k.target.value),children:[e.jsx(S,{value:"admin",children:"Admin"}),e.jsx(S,{value:"sponsor",children:"Sponsor"}),e.jsx(S,{value:"driver",children:"Driver"})]})}),e.jsx(m,{children:e.jsx(Y,{onClick:()=>o(y.userId.toString()),color:"error",size:"small",children:e.jsx(Ve,{})})})]},y.userId))})]})})]})},ut=()=>{const[r,s]=a.useState([]),[t,d]=a.useState(!0),[n,i]=a.useState(""),[l,u]=a.useState("");a.useEffect(()=>{b()},[]);const b=async()=>{try{d(!0);const o=await R.get("/api/admin/sponsors/details");s(o.data),i("")}catch(o){i("Failed to load sponsor data"),console.error("Error fetching sponsors:",o)}finally{d(!1)}},v=async(o,j)=>{try{await R.post("/api/user/change-user-type",{userId:o,newUserType:j}),await b()}catch(y){i(y.message)}},g=async o=>{try{await R.delete(`/api/user/remove-user/${o}`),await b()}catch(j){i(j.message)}},c=r.filter(o=>o.name.toLowerCase().includes(l.toLowerCase())||o.email.toLowerCase().includes(l.toLowerCase())||o.companyName.toLowerCase().includes(l.toLowerCase()));return t?e.jsx(x,{sx:{width:"100%",mt:2},children:e.jsx(ne,{})}):n?e.jsx(W,{severity:"error",sx:{mt:2},children:n}):e.jsxs(x,{sx:{width:"100%",p:3},children:[e.jsx(h,{variant:"h5",gutterBottom:!0,children:"Manage Sponsors"}),e.jsx(x,{sx:{display:"flex",alignItems:"center",mb:3},children:e.jsx(A,{fullWidth:!0,variant:"outlined",placeholder:"Search sponsors by name, email, or company...",value:l,onChange:o=>u(o.target.value),InputProps:{endAdornment:e.jsx(Y,{children:e.jsx(Ne,{})})}})}),e.jsx(ie,{component:ae,children:e.jsxs(le,{children:[e.jsx(ce,{children:e.jsxs(L,{children:[e.jsx(m,{children:"Name"}),e.jsx(m,{children:"Email"}),e.jsx(m,{children:"Company"}),e.jsx(m,{children:"Sponsor Type"}),e.jsx(m,{children:"Point Value ($)"}),e.jsx(m,{children:"User Type"}),e.jsx(m,{children:"Actions"})]})}),e.jsx(de,{children:c.map(o=>e.jsxs(L,{children:[e.jsx(m,{children:o.name}),e.jsx(m,{children:o.email}),e.jsx(m,{children:o.companyName}),e.jsx(m,{children:e.jsx(be,{label:o.sponsorType,color:"primary",size:"small"})}),e.jsxs(m,{children:["$",o.pointDollarValue.toFixed(2)]}),e.jsx(m,{children:e.jsxs(O,{size:"small",value:o.userType||"sponsor",onChange:j=>v(o.userId.toString(),j.target.value),children:[e.jsx(S,{value:"sponsor",children:"Sponsor"}),e.jsx(S,{value:"admin",children:"Admin"}),e.jsx(S,{value:"driver",children:"Driver"})]})}),e.jsx(m,{children:e.jsx(Y,{onClick:()=>g(o.userId.toString()),color:"error",size:"small",children:e.jsx(Ve,{})})})]},o.userId))})]})})]})},pt={MAIN:e.jsx(x,{children:e.jsx(h,{variant:"h6",children:"Dashboard Home"})}),CHANGE_PASSWORD:e.jsx(wr,{}),MANAGE_ADMINS:e.jsx(dt,{}),MANAGE_SPONSORS:e.jsx(ut,{}),MANAGE_DRIVERS:e.jsx(nt,{}),ADMIN_REPORTS:e.jsx(at,{}),ADMIN_AUDIT_REPORTS:e.jsx(it,{}),DRIVER_APPLICATION:e.jsx(Zs,{}),DRIVER_REGISTRATION:e.jsx(st,{}),DRIVER_POINTS:e.jsx(Xs,{}),DRIVER_ACTIVITY:e.jsx(et,{}),DRIVER_POINTS_HISTORY:e.jsx(tt,{}),APPLICATION_MANAGER:e.jsx(Js,{}),SPONSOR_REPORTS:e.jsx(ot,{}),SPONSOR_AUDIT_REPORTS:e.jsx(h,{children:"Audit Reports"}),SPONSOR_DRIVERS:e.jsx(rt,{})};function ht(){const{currentView:r}=Sr();return a.useEffect(()=>{console.log("Rendering MainGrid with current view:",r)},[r]),e.jsx(x,{sx:{width:"100%"},children:pt[r]||e.jsx(h,{children:"Select an option to view content"})})}const xt=()=>{const{user:r,viewRole:s,setViewRole:t}=re();s||(r==null||r.userType);const d=i=>{t(i.target.value)},n=()=>{t(null)};return e.jsxs(x,{sx:{display:"flex",width:"100%",minHeight:"100vh"},children:[e.jsx(xr,{}),e.jsxs(x,{component:"main",sx:{flexGrow:1,display:"flex",flexDirection:"column",ml:"15px"},children:[e.jsx(x,{sx:{p:2},children:e.jsxs(B,{direction:"row",spacing:2,alignItems:"center",children:[e.jsx(h,{variant:"h6",children:"Dashboard"}),r&&(r.userType==="Admin"||r.userType==="Sponsor")&&e.jsxs(O,{value:s||"",onChange:d,displayEmpty:!0,sx:{minWidth:180},renderValue:()=>"Select a role to view",children:[e.jsx(S,{disabled:!0,value:"",children:e.jsx("em",{children:"Select a role to view"})}),r.userType==="Admin"&&[e.jsx(S,{value:"Driver",children:"Driver"},"Driver"),e.jsx(S,{value:"Sponsor",children:"Sponsor"},"Sponsor"),e.jsx(S,{value:"Guest",children:"Guest"},"Guest")],r.userType==="Sponsor"&&e.jsx(S,{value:"Driver",children:"Driver"},"Driver")]}),s&&e.jsx(T,{onClick:n,children:'Exit "View As"'})]})}),e.jsx(ht,{})]})]})},or="productCatalog",gt=10*60*1e3,mt=()=>{const[r,s]=a.useState([]),[t,d]=a.useState(!0),[n,i]=a.useState(null),[l,u]=a.useState([]),[b,v]=a.useState(!1),[g,c]=a.useState([]),[o,j]=a.useState(""),[y,k]=a.useState(""),[M,I]=a.useState(!1);a.useEffect(()=>{z()},[]);const D=w=>{u(E=>[...E,w])},U=()=>v(!0),K=()=>v(!1),xe=()=>u([]);a.useEffect(()=>{const w=localStorage.getItem(or);if(w){const{listings:E,timestamp:Q}=JSON.parse(w);if(Date.now()-Q<gt){s(E),d(!1);return}}se()},[]);const z=async()=>{try{const w=await R.get("/api/driver/my-sponsors");c(w.data),w.data.length>0&&j(w.data[0].sponsorId)}catch(w){i("Failed to load sponsor points data"),console.error("Error fetching sponsor points:",w)}},se=async()=>{var w;try{const Q=(await R.get("/api/catalog/products")).data.map(ve=>({...ve,pointCost:ue(ve.price)}));s(Q),localStorage.setItem(or,JSON.stringify({listings:Q,timestamp:Date.now()}))}catch(E){i(((w=E.response)==null?void 0:w.data)||"Failed to load products.")}finally{d(!1)}},ue=w=>{const E=g.find(ve=>ve.sponsorId===o);if(!E)return 0;const Q=parseFloat(w.split(" ")[0]);return Math.ceil(Q/E.pointDollarValue)},N=w=>{const E=g.find(Q=>Q.sponsorId===o);!E||!w.pointCost||(E.totalPoints<w.pointCost&&k(`Not enough points! You need ${w.pointCost} points but have ${E.totalPoints}`),I(!0))};if(t)return e.jsx(ee,{});if(n)return e.jsx(W,{severity:"error",children:n});const ge=g.find(w=>w.sponsorId===o);return e.jsxs(e.Fragment,{children:[e.jsxs(we,{children:[e.jsx(h,{variant:"h4",component:"h1",gutterBottom:!0,children:"Product Catalog"}),e.jsxs(G,{fullWidth:!0,sx:{mb:4},children:[e.jsx(q,{children:"Select Sponsor"}),e.jsx(O,{value:o,label:"Select Sponsor",onChange:w=>j(w.target.value),children:g.map(w=>e.jsxs(S,{value:w.sponsorId,children:[w.sponsorName," - ",w.totalPoints.toLocaleString()," points available"]},w.sponsorId))})]}),ge&&e.jsxs(W,{severity:"info",sx:{mb:2},children:["You have ",ge.totalPoints.toLocaleString()," points available with ",ge.sponsorName,". Point Value: $",ge.pointDollarValue.toFixed(2)," per point"]}),e.jsx(x,{sx:{display:"flex",flexWrap:"wrap",gap:2,justifyContent:"flex-start"},children:r.map((w,E)=>{var Q;return e.jsxs(te,{sx:{width:"calc(33.333% - 16px)",maxWidth:"calc(33.333% - 16px)",marginBottom:2},children:[e.jsx(bs,{component:"img",height:"200",image:w.imageUrl,alt:w.name,sx:{objectFit:"cover"}}),e.jsxs(oe,{children:[e.jsx(h,{variant:"h6",component:"p",sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:w.name}),e.jsx(pe,{title:"Price",value:w.price}),e.jsx(pe,{title:"Point Cost",value:`${((Q=w.pointCost)==null?void 0:Q.toLocaleString())||0} points`}),e.jsx(T,{fullWidth:!0,variant:"contained",color:"primary",onClick:()=>{N(w),D(w)},disabled:!ge||(w.pointCost||0)>ge.totalPoints,sx:{mt:2},children:"Add to Cart"})]})]},E)})}),e.jsx(mr,{open:M,autoHideDuration:3e3,onClose:()=>I(!1),message:y}),e.jsxs(x,{display:"flex",justifyContent:"center",flexDirection:"column",alignItems:"center",mt:4,gap:2,children:[e.jsx(T,{variant:"contained",color:"secondary",onClick:U,children:"View Cart"}),e.jsx(T,{variant:"outlined",color:"error",onClick:xe,children:"Clear Cart"})]})]}),e.jsxs(jr,{open:b,onClose:K,children:[e.jsx(br,{children:"Your Cart"}),e.jsx(vr,{children:l.length>0?e.jsx(Me,{children:l.map((w,E)=>e.jsx(Ee,{children:e.jsx(Se,{primary:w.name,secondary:`Price: ${parseFloat(w.pointCost).toFixed(2)}`})},E))}):e.jsx(h,{variant:"body1",children:"Your cart is empty."})})]})]})},jt=({text:r,href:s})=>e.jsx("a",{href:s,className:"inline-block border border-blue-500 rounded px-1 text-blue-600 hover:bg-blue-50",style:{display:"inline-block",border:"1px solid #3b82f6",borderRadius:"4px",padding:"0 4px",color:"#2563eb",textDecoration:"none"},onMouseOver:t=>{t.currentTarget.style.backgroundColor="#eff6ff"},onMouseOut:t=>{t.currentTarget.style.backgroundColor="transparent"},children:r}),bt=(r,s)=>{if(!s||s.length===0)return r;let t=r;return s.forEach(n=>{t=t.replace(n.text,`__LINK_${n.text}__`)}),t.split(/__LINK_|__/).map((n,i)=>{const l=s.find(u=>u.text===n);return l?e.jsx(jt,{text:l.text,href:l.href},i):e.jsx("span",{children:n},i)})},vt=({question:r,answer:s,links:t})=>e.jsxs(vs,{children:[e.jsx(ys,{expandIcon:e.jsx(nr,{}),"aria-controls":"panel-content",id:"panel-header",children:e.jsx(h,{children:r})}),e.jsx(fs,{children:e.jsx(h,{component:"div",children:bt(s,t)})})]}),yt=()=>{const r=[{question:"How do I create an account?",answer:"To create an account, click on the 'Sign Up' Button, and from there you will become a guest.",links:[{text:"Sign Up",href:"/register"}]},{question:"How can I become a driver?",answer:"To become a driver, you need to apply with one of the sponsors associated with our program. Once they have accepted your application, you will automatically become a driver."},{question:"What are the password requirements?",answer:"To create a password, it must have a number, a lowercase letter, an uppercase letter, be at least 8 characters long and no characters can be repeated."},{question:"How can I reset my password?",answer:"If you've forgotten your password, click on the 'Forgot Password' link on the login page.",links:[{text:"Forgot Password",href:"/reset-password"},{text:"login page",href:"/login"}]},{question:"How do I earn points?",answer:"To earn points, first you must be associated with at least one sponsor. From there, simply follow instructions from your sponsor to earn points."},{question:"How do I apply to a sponsor?",answer:"To apply to be a sponsor, simply reach out to us and we will create an account for you if you meet our requirements."},{question:"What can I spend my points on?",answer:"You can exchange your points for a variety of items from your sponsors catalog. Each of our sponsors has a unique selection of items.",links:[{text:"sponsors catalog",href:"/catalog"}]}];return e.jsxs("div",{children:[e.jsx(h,{variant:"h4",gutterBottom:!0,children:"Frequently Asked Questions"}),r.map((s,t)=>e.jsx(vt,{question:s.question,answer:s.answer,links:s.links},t))]})},ft=()=>{const[r,s]=a.useState(""),[t,d]=a.useState(""),[n,i]=a.useState(""),[l,u]=a.useState(!1),[b,v]=a.useState(""),g=async o=>{if(o.preventDefault(),!r||!t||!n){v("Please fill in all fields");return}if(!/\S+@\S+\.\S+/.test(t)){v("Please enter a valid email address");return}try{await R.post("/api/feedback",{Name:r,Email:t,Description:n,SubmissionDate:new Date().toISOString()}),console.log("Feedback submitted:",{name:r,email:t,message:n}),u(!0),s(""),d(""),i(""),v("")}catch(j){console.error("Error submitting feedback:",j),v("An error occurred while submitting your feedback. Please try again later.")}},c=(o,j)=>{j!=="clickaway"&&u(!1)};return e.jsxs(x,{component:"form",onSubmit:g,sx:{display:"flex",flexDirection:"column",alignItems:"center",maxWidth:600,margin:"auto",p:3,boxShadow:3,borderRadius:2,backgroundColor:"background.paper"},children:[e.jsx(h,{variant:"h4",component:"h1",gutterBottom:!0,children:"Provide Feedback"}),e.jsx(A,{label:"Your Name",fullWidth:!0,margin:"normal",value:r,onChange:o=>s(o.target.value),required:!0}),e.jsx(A,{label:"Your Email",type:"email",fullWidth:!0,margin:"normal",value:t,onChange:o=>d(o.target.value),required:!0}),e.jsx(A,{label:"Your Feedback",fullWidth:!0,margin:"normal",multiline:!0,rows:4,value:n,onChange:o=>i(o.target.value),required:!0}),e.jsx(T,{type:"submit",variant:"contained",size:"large",fullWidth:!0,sx:{mt:3,mb:2},children:"Submit Feedback"}),b&&e.jsx(h,{color:"error",sx:{mt:2},children:b}),e.jsx(mr,{open:l,autoHideDuration:6e3,onClose:c,children:e.jsx(W,{onClose:c,severity:"success",sx:{width:"100%"},children:"Thank you for your feedback!"})})]})},St=()=>{const[r,s]=a.useState(!1),t=()=>{s(!0)},d=()=>{s(!1)};return e.jsxs(we,{maxWidth:"md",children:[e.jsx(h,{variant:"h4",align:"center",gutterBottom:!0,children:"Secure Checkout"}),e.jsxs(P,{container:!0,spacing:4,children:[e.jsx(P,{item:!0,xs:12,sm:7,children:e.jsxs(x,{children:[e.jsx(h,{variant:"h6",children:"1. Delivery Address"}),e.jsx(h,{variant:"body2",children:"All fields marked with * are required"}),e.jsxs(P,{container:!0,spacing:2,mt:2,children:[" ",e.jsx(P,{item:!0,xs:12,children:e.jsx(A,{label:"Email address *",fullWidth:!0,variant:"outlined"})}),e.jsx(P,{item:!0,xs:6,children:e.jsx(A,{label:"First name *",fullWidth:!0,variant:"outlined"})}),e.jsx(P,{item:!0,xs:6,children:e.jsx(A,{label:"Last name *",fullWidth:!0,variant:"outlined"})}),e.jsx(P,{item:!0,xs:12,children:e.jsx(A,{label:"Address *",fullWidth:!0,variant:"outlined"})}),e.jsx(P,{item:!0,xs:6,children:e.jsx(A,{label:"City *",fullWidth:!0,variant:"outlined"})}),e.jsx(P,{item:!0,xs:6,children:e.jsx(A,{label:"ZIP code *",fullWidth:!0,variant:"outlined"})}),e.jsx(P,{item:!0,xs:12,children:e.jsx(A,{label:"Country *",fullWidth:!0,variant:"outlined",defaultValue:"United States"})})]})]})}),e.jsx(P,{item:!0,xs:12,sm:5,children:e.jsxs(x,{children:[e.jsx(h,{variant:"h6",children:"Order Summary"}),e.jsxs(P,{container:!0,spacing:2,mt:2,alignItems:"center",children:[e.jsxs(P,{item:!0,xs:8,children:[e.jsx(h,{variant:"subtitle1",children:"Bath Mat"}),e.jsx(h,{variant:"body2",children:"Size: 61x43cm, Color: White"})]}),e.jsxs(P,{item:!0,xs:4,textAlign:"right",children:[e.jsx(Y,{size:"small",children:e.jsx(Xe,{})}),"1",e.jsx(Y,{size:"small",children:e.jsx(er,{})})]}),e.jsx(P,{item:!0,xs:12,children:e.jsx(J,{})}),e.jsxs(P,{item:!0,xs:8,children:[e.jsx(h,{variant:"subtitle1",children:"T-Shirt"}),e.jsx(h,{variant:"body2",children:"Size: L, Color: White"})]}),e.jsxs(P,{item:!0,xs:4,textAlign:"right",children:[e.jsx(Y,{size:"small",children:e.jsx(Xe,{})}),"1",e.jsx(Y,{size:"small",children:e.jsx(er,{})})]}),e.jsx(P,{item:!0,xs:12,children:e.jsx(J,{})})]}),e.jsxs(x,{mt:2,textAlign:"right",children:[e.jsx(h,{variant:"h6",children:"Total (2 items): $69.46"})," ",e.jsx(h,{variant:"h6",children:"Current Points: 6946"})," ",e.jsx(T,{variant:"contained",color:"primary",fullWidth:!0,onClick:t,sx:{mt:2},children:"Complete Order"})]})]})})]}),e.jsxs(jr,{open:r,onClose:d,children:[e.jsx(br,{children:"Order Complete"}),e.jsxs(vr,{children:[e.jsx(h,{children:"Your order has been successfully completed! Remaining points: 0"})," "]}),e.jsx(Ss,{children:e.jsx(T,{onClick:d,color:"primary",children:"Close"})})]})]})},ar=({title:r,buttons:s})=>e.jsxs(x,{sx:{mt:3},children:[e.jsx(h,{variant:"h6",gutterBottom:!0,children:r}),s.map((t,d)=>e.jsx(T,{component:he,to:t.path,variant:"contained",sx:{m:1},children:t.label},d))]}),Ct=()=>e.jsxs(x,{sx:{width:"100%",maxWidth:600,margin:"auto",mt:4},children:[e.jsx(h,{variant:"h4",component:"h1",gutterBottom:!0,children:"Settings"}),e.jsx(ar,{title:"Account Settings",buttons:[{label:"Update Email",path:"/update-email"},{label:"Change Password",path:"/change-password"}]}),e.jsx(ar,{title:"Notification Settings",buttons:[{label:"Manage Notifications",path:"/notifications"},{label:"Set Preferences",path:"/preferences"}]})]}),wt=()=>{const{isAuthenticated:r}=re();return r?e.jsxs(x,{sx:{display:"flex"},children:[e.jsx(Bs,{}),e.jsx(x,{sx:{flexGrow:1},children:e.jsx(Tr,{})})]}):e.jsx(Te,{to:"/",replace:!0})},It=()=>{const{isAuthenticated:r}=re();return r?e.jsx(Te,{to:"/dashboard",replace:!0}):e.jsx(Te,{to:"/home",replace:!0})},kt=()=>e.jsx(Cs,{children:e.jsx(ws,{children:e.jsxs(Ns,{children:[e.jsx(Rs,{}),e.jsx(We,{}),e.jsx(x,{sx:{mt:1,width:"100%"},children:e.jsxs(Pr,{children:[e.jsx(H,{path:"/",element:e.jsx(It,{})}),e.jsx(H,{path:"/about",element:e.jsx(Hs,{})}),e.jsx(H,{path:"/login",element:e.jsx(_s,{})}),e.jsx(H,{path:"/register",element:e.jsx(Ys,{})}),e.jsx(H,{path:"/home",element:e.jsx(Us,{})}),e.jsx(H,{path:"/faq",element:e.jsx(yt,{})}),e.jsx(H,{path:"/feedback",element:e.jsx(ft,{})}),e.jsxs(H,{element:e.jsx(wt,{}),children:[e.jsx(H,{path:"/dashboard",element:e.jsx(xt,{})}),e.jsx(H,{path:"/catalog",element:e.jsx(mt,{})}),e.jsx(H,{path:"/change-password",element:e.jsx(wr,{})}),e.jsx(H,{path:"/settings",element:e.jsx(Ct,{})}),e.jsx(H,{path:"/order",element:e.jsx(St,{})})]})]})})]})})});Mr.createRoot(document.getElementById("root")).render(e.jsx(Er,{children:e.jsx(kt,{})}));
